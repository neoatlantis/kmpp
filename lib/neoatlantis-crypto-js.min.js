(function(){var b={},d={},c={};var a={get:function(e){if(true){if(d[e]){return d[e]}}return b[e]},set:function(f,e){b[f]=e},exp:function(g,e){var j=g.split(".");var h=c;for(var f in j){if("undefined"==typeof h[j[f]]){if(f==j.length-1){h[j[f]]=e;break}h[j[f]]={}}h=h[j[f]]}},acc:function(f,e){d[f]=e}};a.set("env.isNode",("undefined"!=typeof module&&"undefined"!=typeof process&&"undefined"!=typeof process.title&&"node"===process.title));(function(k){var f="0123456789abcdefghjkmnpqrtuvwxyz";var i={o:0,i:1,l:1,s:5};var g=function(){var p={};for(var o=0;o<f.length;o++){p[f[o]]=o}for(var n in i){if(!i.hasOwnProperty(n)){continue}p[n]=p[""+i[n]]}g=function(){return p};return p};function h(){var n=0;var o=0;this.output="";this.readByte=function(p){if(n<0){o|=(p>>(-n))}else{o=(p<<n)&248}if(n>3){n-=8;return 1}if(n<4){this.output+=f[o>>3];n+=5}return 0};this.finish=function(){var p=this.output+(n<0?f[o>>3]:"");this.output="";return p}}h.prototype.update=function(p,n){for(var q=0;q<p.length;){q+=this.readByte(p[q])}var o=this.output;this.output="";if(n){o+=this.finish()}return o};function m(){var n=0;var o=0;this.output=[];this.readChar=function(p){var q=g()[p];if(typeof q=="undefined"){throw Error('Could not find character "'+p+'" in lookup table.')}q<<=3;o|=q>>>n;n+=5;if(n>=8){this.output.push(o);n-=8;if(n>0){o=(q<<(5-n))&255}else{o=0}}};this.finish=function(){if(n<0){this.output.push(f[bits>>3])}return this.output}}m.prototype.update=function(p,n){for(var q=0;q<p.length;q++){this.readChar(p[q])}var o=this.output;this.output="";if(n){o.concat(this.finish())}return o};function j(o){var p=new h();var n=p.update(o,true);return n}function e(o){var p=new m();o=o.toLowerCase();var n=p.update(o,true);return n}var l={encode:j,decode:e};k.set("util.encoding.base32",l)})(a);(function(g){function j(n){var m,l,o=0,k;for(m=0;m<n.length;m++){o+=n[m].byteLength}var p=new Uint8Array(o),q=0;for(m=0;m<n.length;m++){k=new Uint8Array(n[m]);for(l=0;l<k.length;l++){p[q]=k[l];q+=1}}return p.buffer}function e(l,k){if(l.byteLength!=k.byteLength){throw Error("xor-unequal-length-buffer")}var o=new Uint8Array(l.byteLength),n=new Uint8Array(l),p=new Uint8Array(k);for(var m=0;m<o.length;m++){o[m]=n[m]^p[m]}return o.buffer}function h(m,l){try{var k=new Uint8Array(m),p=new Uint8Array(l)}catch(o){return false}if(k.length!=p.length){return false}for(var n=0;n<k.length;n++){if(k[n]!=p[n]){return false}}return true}function f(m){var o=new Uint8Array(m);var k=o.length-1,p=Math.floor(k/2);var s=k,q;for(var n=0;n<=p;n++){q=o[n];o[n]=o[s];o[s]=q;s-=1}return o.buffer}var i={concat:j,xor:e,equal:h,reverse:f};g.set("util.buffer",i);g.exp("util.buffer",i)})(a);(function(g){function h(p){var m=4-p.length%4;if(4==m){m=0}for(var n=0;n<m;n++){p.push(0)}var t=[m],l,k,j,s,o;function q(u){if(u<=255){return 0}else{if(u<=65535){return 1}else{if(u<=16777215){return 2}else{if(u<=4294967295){return 3}else{throw Error("uncompressible: "+u)}}}}}function r(v,u){if(u<=255){v.push(u)}else{if(u<=65535){v.push((u&65280)>>8,u&255)}else{if(u<=16777215){v.push((u&16711680)>>16,(u&65280)>>8,u&255)}else{if(u<=4294967295){v.push((u&4278190080)>>24(u&16711680)>>16,(u&65280)>>8,(u&255))}}}}}for(var n=0;n<p.length;n+=4){l=p[n];k=p[n+1];j=p[n+2];s=p[n+3];o=(q(l)<<6)+(q(k)<<4)+(q(j)<<2)+(q(s));t.push(o);r(t,l);r(t,k);r(t,j);r(t,s)}return t}function i(p){var k=p[0];if(k>=4){throw new Error("invalid-input")}var m=1,l;var n,v,t,s,q;function r(w,j){return((w>>(j*2))&3)+1}function u(A,z,y){var x=0;for(var w=z;w<z+y;w++){x=(x<<8);x|=(A[w]&255)}return x}var o=[];while(m<p.length){n=p[m];m++;l=r(n,3);v=u(p,m,l);m+=l;l=r(n,2);t=u(p,m,l);m+=l;l=r(n,1);s=u(p,m,l);m+=l;l=r(n,0);q=u(p,m,l);m+=l;o.push(v,t,s,q)}return o.slice(0,o.length-k)}function e(q){if(!g.get("util.type")(q).isArrayBuffer()){throw Error("invalid-input")}var j=new Uint8Array(q);var l,o={},n,k,p="",r=[],m=256;for(l=0;l<256;l+=1){o[String.fromCharCode(l)]=l}for(l=0;l<j.length;l+=1){n=String.fromCharCode(j[l]);k=p+n;if(o.hasOwnProperty(k)){p=k}else{r.push(o[p]);o[k]=m++;p=String(n)}}if(""!==p){r.push(o[p])}return new Uint8Array(h(r)).buffer}function f(p){if(!g.get("util.type")(p).isArrayBuffer()){throw Error("invalid-input")}var j=new Uint8Array(p);j=i(j);var m,q=[],s,t,l,r="",n=256;for(m=0;m<256;m+=1){q[m]=String.fromCharCode(m)}s=String.fromCharCode(j[0]);t=s;for(m=1;m<j.length;m+=1){l=j[m];if(q[l]){r=q[l]}else{if(l===n){r=s+s.charAt(0)}else{return null}}t+=r;q[n++]=s+r.charAt(0);s=r}var o=new Uint8Array(t.length);for(var m=0;m<o.length;m++){o[m]=t.charCodeAt(m)}return o.buffer}g.exp("util.compress",e);g.exp("util.decompress",f);g.set("util.compress",e);g.set("util.decompress",f)})(a);(function(f){function e(o){if(!0==o.byteLength%2){throw new Error("decoding-error")}var o=new Uint16Array(o),k=0,m,j,n,l="";while(k<o.length){m=o[k];if((m>=0&&m<=55295)||(m>=57344&&m<=65535)){l+=String.fromCharCode(m);k+=1}else{if(m>=55296&&m<=56319){n=m;j=o[k+1];k+=2;if(j>=56320&&j<=57343){l+=String.fromCharCode(n)+String.fromCharCode(j)}else{throw new Error("decoding-error")}}else{throw new Error("decoding-error")}}}return l}function g(m,w){var o=this;var s=null;var k="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",u="0123456789abcdef";var l=f.get("util.type")(m),y=f.get("util.encoding.base32");if(l.isArrayBuffer()){s=m}else{if(l.isArray()){var r=new Uint8Array(m.length);for(var v=0;v<r.length;v++){r[v]=m[v]&255}s=r.buffer}else{if(l.isString()){if(!w){w=""}switch(w.toLowerCase()){case"hex":if(!/^[0-9a-f]+$/i.test(m)||0!=m.length%2){throw Error("invalid-encoding-choosen")}m=m.toLowerCase();var p=new Uint8Array(m.length/2);for(var v=0;v<p.length;v++){p[v]=u.indexOf(m[2*v])*16+u.indexOf(m[2*v+1])}s=p.buffer;break;case"base64":if(/(=[^=]+|={3,})$/.test(m)){throw Error("invalid-encoding-choosen")}m=m.replace(/=/g,"");var q=m.length&3;if(1==q){throw Error("invalid-encoding-choosen")}var v=0,t=0,x=Math.ceil(m.length/4);var p=new Uint8Array(x*3);var D,C,B,z;for(v=0;v<x;v++){D=k.indexOf(m[t++]||"A");C=k.indexOf(m[t++]||"A");B=k.indexOf(m[t++]||"A");z=k.indexOf(m[t++]||"A");if((D|C|B|z)<0){throw Error("invalid-encoding-choosen")}p[v*3]=((D<<2)|(C>>4))&255;p[v*3+1]=((C<<4)|(B>>2))&255;p[v*3+2]=((B<<6)|z)&255}s=p.buffer.slice(0,p.length+q-4);break;case"base32":if(!/^[0-9a-z=]+$/.test(m)){throw Error("invalid-encoding-choosen")}var A=y.decode(m);s=new Uint8Array(A).buffer;break;case"ascii":var p=new Uint8Array(m.length);for(var v=0;v<p.length;v++){p[v]=m.charCodeAt(v)&255}s=p.buffer;break;default:var p=new Uint16Array(m.length);for(var v=0;v<m.length;v++){p[v]=m.charCodeAt(v)}s=p.buffer;break}}else{throw Error("unknown-encoding")}}}this.toArrayBuffer=function(){return s};this.toUTF16=function(){return e(s)};this.toBase64=function(){var J=new Uint8Array(s);var G=0,F=0,E=0,H=J.length/3;var n="";var L,K,I;for(G=0;G<H;++G){L=J[F++];K=J[F++];I=J[F++];n+=k[L>>2]+k[((L<<4)&63)|(K>>4)]+(isNaN(K)?"=":k[((K<<2)&63)|(I>>6)])+(isNaN(K+I)?"=":k[I&63])}return n};this.toBase32=function(){var i=new Uint8Array(s),j=y.encode(i);return j};this.toHEX=function(){var j=new Uint8Array(s),E="";for(var n=0;n<j.length;n++){if(j[n]<16){E+="0"+j[n].toString(16)}else{E+=j[n].toString(16)}}return E};this.toASCII=function(){var j=new Uint8Array(s),E="";for(var n=0;n<j.length;n++){E+=String.fromCharCode(j[n])}return E};this.toArray=function(){var j=new Uint8Array(s),n=new Array(j.length);for(var E=0;E<n.length;E++){n[E]=j[E]}return n};return this}var h=function(j,i){return new g(j,i)};f.set("util.encoding",h);f.exp("util.encoding",h)})(a);(function(e){var f={notice:function(g){console.log(g)},error:function(g){console.error(g)}};e.set("util.log",f);e.exp("util.log",f)})(a);(function(n){n.set("util.srand.getRandomBytes",function(x){var v=new Uint8Array(x);for(var w=0;w<x;w++){v[x]=Math.floor(256*Math.random())}return v});var e=new Uint32Array(16);function h(A,w){function z(x,i){return(((x)<<(i))|((x)>>>(32-(i))))}var y;var v=e;for(y=0;y<16;y++){v[y]=A[y]}for(y=0;y<32;y++){v[4]^=z(v[0]+v[12],7);v[8]^=z(v[4]+v[0],9);v[12]^=z(v[8]+v[4],13);v[0]^=z(v[12]+v[8],18);v[9]^=z(v[5]+v[1],7);v[13]^=z(v[9]+v[5],9);v[1]^=z(v[13]+v[9],13);v[5]^=z(v[1]+v[13],18);v[14]^=z(v[10]+v[6],7);v[2]^=z(v[14]+v[10],9);v[6]^=z(v[2]+v[14],13);v[10]^=z(v[6]+v[2],18);v[3]^=z(v[15]+v[11],7);v[7]^=z(v[3]+v[15],9);v[11]^=z(v[7]+v[3],13);v[15]^=z(v[11]+v[7],18);v[1]^=z(v[0]+v[3],7);v[2]^=z(v[1]+v[0],9);v[3]^=z(v[2]+v[1],13);v[0]^=z(v[3]+v[2],18);v[6]^=z(v[5]+v[4],7);v[7]^=z(v[6]+v[5],9);v[4]^=z(v[7]+v[6],13);v[5]^=z(v[4]+v[7],18);v[11]^=z(v[10]+v[9],7);v[8]^=z(v[11]+v[10],9);v[9]^=z(v[8]+v[11],13);v[10]^=z(v[9]+v[8],18);v[12]^=z(v[15]+v[14],7);v[13]^=z(v[12]+v[15],9);v[14]^=z(v[13]+v[12],13);v[15]^=z(v[14]+v[13],18)}for(y=0;y<16;y++){w[y]=v[y]+A[y]}}var m=new Uint8Array(16);function r(){for(var v=0;v<16;v++){m[v]=Math.floor(256*Math.random())}}r();var f=new Uint32Array([0,0]);function o(){f[0]=0;f[1]=0}function q(){f[0]+=1;if(0==f[0]){f[1]+=1}if(0==f[1]){r()}}var s=new Uint8Array(32),g=0;function u(i){s[g]=i;g+=1;if(g>=32){o();g=0}}var t=n.get("util.srand.getRandomBytes")(32);for(var k=0;k<32;k++){u(t[k])}function j(){u(new Date().getTime()%256)}setInterval(j,100);function l(v){var x=new Uint32Array([1634760805,857760878,2036477234,1797285236]);var i=new Uint32Array(16),w=new Uint32Array(m.buffer),y=new Uint32Array(s.buffer);i[0]=x[0];i[1]=y[0];i[2]=y[1];i[3]=y[2];i[4]=y[3];i[5]=x[1];i[6]=w[0];i[7]=w[1];i[8]=f[0];i[9]=f[1];i[10]=x[2];i[11]=y[4];i[12]=y[5];i[13]=y[6];i[14]=y[7];i[15]=x[3];q();return h(i,v)}function p(){var i=this;var v=new Uint32Array(16);this.touch=function(){j()};this.bytes=function(C){var w=Math.ceil(C/64);var z=new Uint8Array(C),A=0,y=0,D;var x=n.get("util.srand.getRandomBytes")(C);for(var B=0;B<w;B++){l(v);D=new Uint8Array(v.buffer);for(A=0;A<64;A++){if(y>=C){break}z[y]=D[A]^x[y];y+=1}}return z.buffer};this.array=function(w){return new Uint8Array(i.bytes(w))};return this}n.set("util.srand",p);n.exp("util.srand",p)})(a);(function(e){function f(i){var o=this;var l="secureStorage";var m;function l(q){if(!/^[0-9a-z].+$/i.test(l)){throw new Error("invalid-prefix")}l=q;delete o.prefix}function k(r){var p=e.get("util.encoding")(r).toArrayBuffer();var w=i.getItem(l);if(null==w){throw new Error("storage-not-exists")}if(!e.get("util.type")(w).isString()){var q=e.get("cipher.symmetric")();q.key(p);m=new e.get("util.srand")().bytes(128);w=e.get("util.encoding")(q.encrypt(m)).toBase64();i.setItem(l,w)}else{try{var u=e.get("util.encoding")(w,"base64").toArrayBuffer();var q=e.get("cipher.symmetric")();q.key(p);m=q.decrypt(u)}catch(t){throw new Error("storage-corrupted")}}var s=j();if(!s){throw new Error("storage-corrupted")}return function v(){s._close();h()}}function g(p,q){}function h(){m=null;o.open=k;o.changeKey=g;o.prefix=l;delete o.setItem;delete o.getItem;delete o.length;delete o.removeItem;delete o.key}function n(){var p=false;var q={};var s=e.get("cipher.symmetric")();s.key(m);var t={};function u(w){if(undefined!=t[w]){return t[w]}var v=s.encrypt(w);v=l+"-"+e.get("util.encoding")(v).toBase32();t[w]=v;return v}function r(){var y,z=l+"-",w,v;for(var x=0;x<i.length;x++){y=i.key(x);if(y.slice(0,z.length)!=z){continue}try{w=y.slice(z.length);v=e.get("util.encoding")(s.decrypt(e.get("util.encoding")(w,"base32").toArrayBuffer())).toUTF16()}catch(A){continue}t[v]=y}}r();q.setItem=function(w,z){if(p){throw new Error("storage-closed")}if(!e.get("util.type")(w).isString()){throw new Error("invalid-storage-key")}var v=e.get("util.encoding")(JSON.stringify(z)).toArrayBuffer();var x=s.encrypt(v);var y=u(w);i.setItem(y,e.get("util.encoding")(x).toBase64())};q.getItem=function(w){if(p){throw new Error("storage-closed")}if(!e.get("util.type")(w).isString()){throw new Error("invalid-storage-key")}try{var z=u(w);var y=i.getItem(z);var x=e.get("util.encoding")(y,"base64").toArrayBuffer();var v=e.get("util.encoding")(s.decrypt(x)).toUTF16();return JSON.parse(v)}catch(A){console.log(A);return null}};q.getLength=function(){};q._close=function(){p=true;s=null};return q}function j(){try{var p=new n()}catch(q){return false}Object.defineProperty(o,"length",{enumerable:true,configurable:true,writable:false,get:p.getLength});o.setItem=p.setItem;o.getItem=p.getItem;delete o.open;delete o.changeKey;delete o.prefix;return p._close}h();return this}})(a);(function(e){function f(g){return{isError:function(){return toString.apply(g)==="[object Error]"},isArray:function(){return toString.apply(g)==="[object Array]"},isObject:function(){return !!g&&Object.prototype.toString.call(g)==="[object Object]"},isPrimitive:function(){return self.isString(g)||self.isNumber(g)||self.isBoolean(g)},isFunction:function(){return toString.apply(g)==="[object Function]"},isDate:function(){return toString.apply(g)==="[object Date]"},isNumber:function(){return typeof g==="number"&&isFinite(g)},isString:function(){return typeof g==="string"},isBoolean:function(){return typeof g==="boolean"},isArrayBuffer:function(){return toString.apply(g)==="[object ArrayBuffer]"}}}e.set("util.type",f);e.exp("util.type",f)})(a);(function(e){e.exp("util.uuid",function(){var f=new e.get("util.srand")().bytes(16);var g=e.get("util.encoding")(f).toHEX();return String(g.slice(0,8)+"-"+g.slice(8,12)+"-"+g.slice(12,16)+"-"+g.slice(16,20)+"-"+g.slice(20,32))})})(a);(function(e){function f(i){var h=this;var g=e.get("util.type");this.pack=function(m){if(!Boolean(m)){m=[]}else{if(m.length>255){throw new Error("invalid-parameter")}for(var l=0;l<m.length;l++){if(!g(m[l]).isArrayBuffer()){throw new Error("invalid-parameter")}}}var n=[];for(var l in m){var j=m[l].byteLength;if(1==i){if(j>255){throw new Error("invalid-parameter")}var k=new Uint8Array([j]).buffer}else{if(2==i){if(j>65535){throw new Error("invalid-parameter")}var k=new Uint16Array([j]).buffer}}n.push(e.get("util.buffer").concat([k,m[l]]))}k=new Uint8Array([m.length]).buffer;n.unshift(k);return e.get("util.buffer").concat(n)};this.unpack=function(m){var k=0,j=0,p;var o=m.slice(0,1);m=m.slice(1);k=new Uint8Array(o)[0];var l=[];for(var n=0;n<k;n++){o=m.slice(0,i);m=m.slice(i);if(1==i){j=new Uint8Array(o)[0]}else{if(2==i){j=new Uint16Array(o)[0]}}p=m.slice(0,j);m=m.slice(j);l.push(p)}return[l,m]};return this}e.set("util.serialize.array",function(g){g.array=function(){return new f(2)};g.shortArray=function(){return new f(1)}})})(a);(function(f){function e(h){var g=this;this.unpack=function(i){var k;var j=i.slice(0,4);if(4==h){k=new Uint32Array(j)[0];i=i.slice(4)}else{if(2==h){k=new Uint16Array(j)[0];i=i.slice(2)}else{if(1==h){k=new Uint8Array(j)[0];i=i.slice(1)}}}if(0==k){return[null,i]}unpackResult=i.slice(0,k);i=i.slice(k);return[unpackResult,i]};this.pack=function(i){if(!Boolean(i)){i=new Uint8Array(0).buffer}if(!f.get("util.type")(i).isArrayBuffer()){throw new Error("invalid-parameter")}packLength=i.byteLength;if((4==h&&packLength>4294967295)||(2==h&&packLength>65535)||(1==h&&packLength>255)){throw new Error("invalid-parameter")}if(4==h){var j=new Uint32Array(1)}else{if(2==h){var j=new Uint16Array(1)}else{if(1==h){var j=new Uint8Array(1)}}}j[0]=packLength;j=j.buffer;return f.get("util.buffer").concat([j,i])};return this}f.set("util.serialize.binary",function(g){g.shortBinary=function(){return new e(1)};g.binary=function(){return new e(2)};g.longBinary=function(){return new e(4)}})})(a);(function(f){function e(){var g=this;this.pack=function(h){if(!f.get("util.type")(h).isBoolean()){throw new Error("invalid-parameter")}var i=new Uint8Array([(h?255:0)]).buffer;return i};this.unpack=function(h){var i=new Uint8Array(h.slice(0,1))[0];h=h.slice(1);return[Boolean(255==i),h]};return this}f.set("util.serialize.boolean",function(g){g["boolean"]=function(){return new e()}})})(a);(function(e){function f(i){var h=this;var g=e.get("util.type");if(!g(i).isArray()){throw new Error("invalid-parameter")}var j=false;i=i[0];if(g(i).isString()){i=e.get("util.encoding")(i).toArrayBuffer();j=true}if(!g(i).isArrayBuffer()){throw new Error("invalid-parameter")}this.pack=function(){return i};this.unpack=function(k){var l=k.slice(0,i.byteLength);k=k.slice(i.byteLength);if(!e.get("util.buffer").equal(l,i)){throw new Error("unexpected-constant")}if(j){l=e.get("util.encoding")(l).toUTF16()}return[l,k]};return this}e.set("util.serialize.constant",function(g){g.constant=function(h){return new f(h)}})})(a);(function(f){function e(){var h=this;var g=f.get("util.type");this.pack=function(k){if(!Boolean(k)){return new Uint16Array([0]).buffer}if(!g(k).isDate()){if(g(k).isString()){try{k=new Date(k)}catch(n){throw new Error("invalid-parameter")}}else{throw new Error("invalid-parameter")}}var l=k.getUTCFullYear()&65535,i=(k.getUTCMonth()+1)&255,p=k.getUTCDate()&255,q=k.getUTCHours()&255,o=k.getUTCMinutes()&255,m=k.getUTCSeconds()&255;if(0==l){throw new Error("invalid-parameter")}var j=f.get("util.buffer").concat([new Uint16Array([l]).buffer,new Uint8Array([i,p,q,o,m]).buffer]);return j};this.unpack=function(j){var o=new Uint16Array(j.slice(0,2))[0];if(0==o){j=j.slice(2);return[null,j]}var m=new Uint8Array(j.slice(2,3))[0],n=new Uint8Array(j.slice(3,4))[0],l=new Uint8Array(j.slice(4,5))[0],k=new Uint8Array(j.slice(5,6))[0],p=new Uint8Array(j.slice(6,7))[0];j=j.slice(7);var i=new Date();i.setUTCMilliseconds(0);i.setUTCSeconds(p);i.setUTCMinutes(k);i.setUTCHours(l);i.setUTCDate(n);i.setUTCMonth(m);i.setUTCFullYear(o);return[i,j]};return this}f.set("util.serialize.datetime",function(g){g.datetime=function(){return new e()}})})(a);(function(e){function f(h){var g=this;if(!e.get("util.type")(h).isArray()||h.length>255){throw new Error("invalid-parameter")}this.pack=function(k){var j=h.indexOf(k);if(j<0){throw new Error("not-enum-item")}var i=new Uint8Array([j]);return i.buffer};this.unpack=function(i){var j=new Uint8Array(i.slice(0,1))[0];i=i.slice(1);if(j>=h.length){throw new Error("invalid-enum-value")}return[h[j],i]};return this}e.set("util.serialize.enum",function(g){g["enum"]=function(h){return new f(h)}})})(a);(function(f){var h=false;function e(k){var r=this;var l=f.get("util.type");if(!l(k).isObject()){throw new Error("invalid-data-structure")}var m=Object.keys(k).sort(),j=[];for(var o in m){var q=m[o];var p,n;if(l(k[q]).isString()){p=k[q];n=[]}else{p=k[q][0];n=k[q].slice(1)}if(!h[p]){throw new Error("invalid-data-structure")}j.push(h[p](n))}this.serialize=function(v){if(!l(v).isObject()){throw new Error("invalid-parameter")}var s=[];for(var u in j){var t=m[u];s.push(j[u].pack(v[t]))}return f.get("util.buffer").concat(s)};this.deserialize=function(t){if(!l(t).isArrayBuffer()){throw new Error("invalid-parameter")}var u={};for(var w in m){var v=m[w];var s=j[w].unpack(t);u[v]=s[0];t=s[1]}return u};return this}var g=function(i){if(false===h){h={};f.get("util.serialize.enum")(h);f.get("util.serialize.binary")(h);f.get("util.serialize.boolean")(h);f.get("util.serialize.constant")(h);f.get("util.serialize.array")(h);f.get("util.serialize.datetime")(h)}return new e(i)};f.set("util.serialize",g)})(a);(function(f){function g(m,k){if(typeof m==="undefined"){m=32}this.isFinished=false;this.digestLength=32;this.blockLength=64;this.iv=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];if(m<=0){m=this.digestLength}else{if(m>32){throw"digestLength is too large"}}var h=0;if(typeof k=="string"){k=this.stringToUtf8Array(k);h=k.length}else{if(typeof k=="object"){h=k.length}}if(h>32){throw"key too long"}var l=[m&255,h,1,1];this.h=this.iv.slice(0);this.h[0]^=this.load32(l,0);this.x=new Array(64);this.t0=0;this.t1=0;this.f0=0;this.f1=0;this.nx=0;this.digestLength=m;if(h>0){for(var j=0;j<h;j++){this.x[j]=k[j]}for(var j=h;j<64;j++){this.x[j]=0}this.nx=64}}g.prototype.load32=function(h,i){return((h[i]&255)|((h[i+1]&255)<<8)|((h[i+2]&255)<<16)|((h[i+3]&255)<<24))>>>0};g.prototype.store32=function(i,j,h){i[j]=(h>>>0)&255;i[j+1]=(h>>>8)&255;i[j+2]=(h>>>16)&255;i[j+3]=(h>>>24)&255};g.prototype.processBlock=function(s){this.t0+=s;if(this.t0!=this.t0>>>0){this.t0=0;this.t1++}var r=this.h[0],q=this.h[1],p=this.h[2],o=this.h[3],m=this.h[4],k=this.h[5],i=this.h[6],N=this.h[7],L=this.iv[0],J=this.iv[1],G=this.iv[2],D=this.iv[3],A=this.iv[4]^this.t0,x=this.iv[5]^this.t1,v=this.iv[6]^this.f0,t=this.iv[7]^this.f1;var n=this.load32(this.x,0),l=this.load32(this.x,4),j=this.load32(this.x,8),h=this.load32(this.x,12),M=this.load32(this.x,16),K=this.load32(this.x,20),I=this.load32(this.x,24),F=this.load32(this.x,28),C=this.load32(this.x,32),z=this.load32(this.x,36),H=this.load32(this.x,40),E=this.load32(this.x,44),B=this.load32(this.x,48),y=this.load32(this.x,52),w=this.load32(this.x,56),u=this.load32(this.x,60);r+=n;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=j;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=M;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=I;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=K;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=F;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=h;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=l;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=C;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=H;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=B;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=w;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=y;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=u;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=E;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=z;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=w;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=M;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=z;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=y;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=u;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=I;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=C;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=H;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=l;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=n;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=E;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=K;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=F;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=h;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=j;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=B;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=E;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=B;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=K;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=u;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=j;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=y;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=n;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=C;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=H;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=h;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=F;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=z;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=l;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=M;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=I;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=w;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=F;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=h;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=y;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=E;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=B;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=w;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=l;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=z;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=j;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=K;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=M;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=u;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=n;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=C;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=H;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=I;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=z;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=K;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=j;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=H;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=M;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=u;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=F;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=n;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=w;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=E;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=I;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=h;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=C;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=y;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=B;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=l;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=j;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=I;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=n;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=C;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=E;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=h;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=H;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=B;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=M;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=F;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=u;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=l;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=w;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=z;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=K;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=y;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=B;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=l;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=w;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=M;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=y;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=H;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=u;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=K;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=n;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=I;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=z;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=C;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=j;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=E;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=h;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=F;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=y;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=F;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=B;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=h;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=l;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=z;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=w;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=E;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=K;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=u;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=C;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=j;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=I;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=H;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=M;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=n;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=I;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=w;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=E;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=n;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=h;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=C;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=z;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=u;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=B;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=y;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=l;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=H;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=M;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=K;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=F;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=i<<(32-7)|i>>>7;r+=j;r+=k;t^=r;t=t<<(32-8)|t>>>8;G+=t;k^=G;k=k<<(32-7)|k>>>7;r+=H;r+=m;A^=r;A=A<<(32-16)|A>>>16;L+=A;m^=L;m=m<<(32-12)|m>>>12;q+=C;q+=k;x^=q;x=x<<(32-16)|x>>>16;J+=x;k^=J;k=k<<(32-12)|k>>>12;p+=F;p+=i;v^=p;v=v<<(32-16)|v>>>16;G+=v;i^=G;i=i<<(32-12)|i>>>12;o+=l;o+=N;t^=o;t=t<<(32-16)|t>>>16;D+=t;N^=D;N=N<<(32-12)|N>>>12;p+=I;p+=i;v^=p;v=v<<(32-8)|v>>>8;G+=v;i^=G;i=i<<(32-7)|i>>>7;o+=K;o+=N;t^=o;t=t<<(32-8)|t>>>8;D+=t;N^=D;N=N<<(32-7)|N>>>7;q+=M;q+=k;x^=q;x=x<<(32-8)|x>>>8;J+=x;k^=J;k=k<<(32-7)|k>>>7;r+=j;r+=m;A^=r;A=A<<(32-8)|A>>>8;L+=A;m^=L;m=m<<(32-7)|m>>>7;r+=u;r+=k;t^=r;t=t<<(32-16)|t>>>16;G+=t;k^=G;k=k<<(32-12)|k>>>12;q+=z;q+=i;A^=q;A=A<<(32-16)|A>>>16;D+=A;i^=D;i=i<<(32-12)|i>>>12;p+=h;p+=N;x^=p;x=x<<(32-16)|x>>>16;L+=x;N^=L;N=N<<(32-12)|N>>>12;o+=y;o+=m;v^=o;v=v<<(32-16)|v>>>16;J+=v;m^=J;m=m<<(32-12)|m>>>12;p+=B;p+=N;x^=p;x=x<<(32-8)|x>>>8;L+=x;N^=L;N=N<<(32-7)|N>>>7;o+=n;o+=m;v^=o;v=v<<(32-8)|v>>>8;J+=v;m^=J;m=m<<(32-7)|m>>>7;q+=w;q+=i;A^=q;A=A<<(32-8)|A>>>8;D+=A;i^=D;i=(i<<(32-7))|(i>>>7);r+=E;r+=k;t^=r;t=(t<<(32-8))|(t>>>8);G+=t;k^=G;k=(k<<(32-7))|(k>>>7);this.h[0]^=r^L;this.h[1]^=q^J;this.h[2]^=p^G;this.h[3]^=o^D;this.h[4]^=m^A;this.h[5]^=k^x;this.h[6]^=i^v;this.h[7]^=N^t};g.prototype.stringToUtf8Array=function(k){var h=[];for(var j=0;j<k.length;j++){var l=k.charCodeAt(j);if(l<128){h.push(l)}else{if(l>127&&l<2048){h.push((l>>6)|192);h.push((l&63)|128)}else{h.push((l>>12)|224);h.push(((l>>6)&63)|128);h.push((l&64)|128)}}}return h};g.prototype.update=function(l,m,j){if(typeof m==="undefined"){m=0}if(typeof j==="undefined"){j=l.length}if(this.isFinished){throw"update() after calling digest()"}if(typeof l=="string"){if(m!=0){throw"offset not supported for strings"}l=this.stringToUtf8Array(l);j=l.length;m=0}else{if(typeof l!="object"){throw"unsupported object: string or array required"}}if(j==0){return}var k=64-this.nx;if(j>k){for(var h=0;h<k;h++){this.x[this.nx+h]=l[m+h]}this.processBlock(64);m+=k;j-=k;this.nx=0}while(j>64){for(var h=0;h<64;h++){this.x[h]=l[m+h]}this.processBlock(64);m+=64;j-=64;this.nx=0}for(var h=0;h<j;h++){this.x[this.nx+h]=l[m+h]}this.nx+=j};g.prototype.digest=function(){if(this.isFinished){return this.result}for(var k=this.nx;k<64;k++){this.x[k]=0}this.f0=4294967295;this.processBlock(this.nx);var j=new Array(32);for(var k=0;k<8;k++){var l=this.h[k];j[k*4+0]=(l>>>0)&255;j[k*4+1]=(l>>>8)&255;j[k*4+2]=(l>>>16)&255;j[k*4+3]=(l>>>24)&255}this.result=j.slice(0,this.digestLength);this.isFinished=true;return this.result};function e(j){var h=this;this.name="BLAKE2s";this.blockSize=32;if(j&&f.get("util.type")(j.length).isNumber()&&j.length<=32&&j.length>=1){this.digestSize=Math.floor(j.length)}else{this.digestSize=32}function i(m,l){if(l){var k=new g(h.digestSize,new Uint8Array(l))}else{var k=new g(h.digestSize)}k.update(new Uint8Array(m));return new Uint8Array(k.digest()).buffer}this.mac=function(l,k){if(k.byteLength>32){k=k.slice(0,32)}return i(l,k)};this.hash=function(k){return i(k)};return this}f.set("hash.algorithms.blake2s",e)})(a);(function(f){var g={};function h(l,k){var j=this;this.algorithms=["ripemd160","blake2s","whirlpool"];l=l.toLowerCase();if(this.algorithms.indexOf(l)<0){throw new Error("hash-algorithm-unknown")}var n=f.get("hash.algorithms."+l);function m(o){return{hex:f.get("util.encoding")(o).toHEX(),buffer:o}}this.hash=function(p){if(!f.get("util.type")(p).isArrayBuffer()){throw Error("invalid-parameter")}var o=new n(k);return m(o.hash(p))};this.mac=function(q,r){if(!(f.get("util.type")(r).isArrayBuffer()&&f.get("util.type")(q).isArrayBuffer())){throw Error("invalid-parameter")}var p;var o=new n(k);if(f.get("util.type")(o.mac).isFunction()){p=o.mac(q,r)}else{p=i(o.hash,r,q,o.blockSize)}return m(p)};this.pbkdf2=function(p,o,r,q){if(!(f.get("util.type")(p).isArrayBuffer()&&f.get("util.type")(o).isArrayBuffer()&&r>0&&q>0)){throw Error("invalid-parameter")}return e(j.mac,new n().digestSize,p,o,r,q)};return this}function i(u,l,n,r){if(l.byteLength>r){l=new Uint8Array(u(l))}else{if(l.byteLength<r){var j=new Uint8Array(r),q=new Uint8Array(l);for(var o=0;o<j.length;o++){if(o<l.byteLength){j[o]=q[o]}else{j[o]=0}}l=j}}var v=new Uint8Array(r);var m=new Uint8Array(r);for(var o=0;o<r;o++){v[o]=92^l[o];m[o]=54^l[o]}var k=f.get("util.buffer").concat([m.buffer,n]),s=u(k);var t=f.get("util.buffer").concat([v.buffer,s]),p=u(t);return p}function e(x,v,r,o,m,k){var w=Math.ceil(k/v);var t=new Array(w);for(var q=0;q<w;q++){var s=false;var l=new Uint32Array([q]);var u=f.get("util.buffer").concat([o,l.buffer]);for(var p=0;p<m;p++){var n=x(r,u).buffer;if(false===s){s=n}else{s=f.get("util.buffer").xor(n,s)}u=n}t[q]=s}return f.get("util.buffer").concat(t).slice(0,k)}f.exp("hash",h);f.set("hash",h)})(a);(function(i){var j=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13];var g=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11];var t=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6];var s=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11];var h=[0,1518500249,1859775393,2400959708,2840853838];var v=[1352829926,1548603684,1836072691,2053994217,0];var e=function(x){var z=[];for(var y=0,w=0;y<x.length;y++,w+=8){z[w>>>5]|=x[y]<<(24-w%32)}return z};var k=function(y){var x=[];for(var w=0;w<y.length*32;w+=8){x.push((y[w>>>5]>>>(24-w%32))&255)}return x};var u=function(J,F,A){for(var B=0;B<16;B++){var L=A+B;var G=F[L];F[L]=((((G<<8)|(G>>>24))&16711935)|(((G<<24)|(G>>>8))&4278255360))}var D,x,I,C,w;var z,O,E,y,K;z=D=J[0];O=x=J[1];E=I=J[2];y=C=J[3];K=w=J[4];var N;for(var B=0;B<80;B+=1){N=(D+F[A+j[B]])|0;if(B<16){N+=r(x,I,C)+h[0]}else{if(B<32){N+=q(x,I,C)+h[1]}else{if(B<48){N+=p(x,I,C)+h[2]}else{if(B<64){N+=o(x,I,C)+h[3]}else{N+=n(x,I,C)+h[4]}}}}N=N|0;N=m(N,t[B]);N=(N+w)|0;D=w;w=C;C=m(I,10);I=x;x=N;N=(z+F[A+g[B]])|0;if(B<16){N+=n(O,E,y)+v[0]}else{if(B<32){N+=o(O,E,y)+v[1]}else{if(B<48){N+=p(O,E,y)+v[2]}else{if(B<64){N+=q(O,E,y)+v[3]}else{N+=r(O,E,y)+v[4]}}}}N=N|0;N=m(N,s[B]);N=(N+K)|0;z=K;K=y;y=m(E,10);E=O;O=N}N=(J[1]+I+y)|0;J[1]=(J[2]+C+K)|0;J[2]=(J[3]+w+z)|0;J[3]=(J[4]+D+O)|0;J[4]=(J[0]+x+E)|0;J[0]=N};function r(w,B,A){return((w)^(B)^(A))}function q(w,B,A){return(((w)&(B))|((~w)&(A)))}function p(w,B,A){return(((w)|(~(B)))^(A))}function o(w,B,A){return(((w)&(A))|((B)&(~(A))))}function n(w,B,A){return((w)^((B)|(~(A))))}function m(w,y){return(w<<y)|(w>>>(32-y))}function f(D){var C=[1732584193,4023233417,2562383102,271733878,3285377520],E=new Uint8Array(D);var x=e(E);var B=E.length*8;var A=E.length*8;x[B>>>5]|=128<<(24-B%32);x[(((B+64)>>>9)<<4)+14]=((((A<<8)|(A>>>24))&16711935)|(((A<<24)|(A>>>8))&4278255360));for(var y=0;y<x.length;y+=16){u(C,x,y)}var w;for(var y=0;y<5;y++){w=C[y];C[y]=(((w<<8)|(w>>>24))&16711935)|(((w<<24)|(w>>>8))&4278255360)}var z=k(C);return new Uint8Array(z).buffer}function l(){var w=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(x){return f(x)};return this}i.set("hash.algorithms.ripemd160",l)})(a);(function(k){var H,m=10,z=[],B=[],w,v,G,A,F,j,h,f,e,M,J,y="\u1823\uc6E8\u87B8\u014F\u36A6\ud2F5\u796F\u9152\u60Bc\u9B8E\uA30c\u7B35\u1dE0\ud7c2\u2E4B\uFE57\u1577\u37E5\u9FF0\u4AdA\u58c9\u290A\uB1A0\u6B85\uBd5d\u10F4\ucB3E\u0567\uE427\u418B\uA77d\u95d8\uFBEE\u7c66\udd17\u479E\ucA2d\uBF07\uAd5A\u8333\u6302\uAA71\uc819\u49d9\uF2E3\u5B88\u9A26\u32B0\uE90F\ud580\uBEcd\u3448\uFF7A\u905F\u2068\u1AAE\uB454\u9322\u64F1\u7312\u4008\uc3Ec\udBA1\u8d3d\u9700\ucF2B\u7682\ud61B\uB5AF\u6A50\u45F3\u30EF\u3F55\uA2EA\u65BA\u2Fc0\udE1c\uFd4d\u9275\u068A\uB2E6\u0E1F\u62d4\uA896\uF9c5\u2559\u8472\u394c\u5E78\u388c\ud1A5\uE261\uB321\u9c1E\u43c7\uFc04\u5199\u6d0d\uFAdF\u7E24\u3BAB\ucE11\u8F4E\uB7EB\u3c81\u94F7\uB913\u2cd3\uE76E\uc403\u5644\u7FA9\u2ABB\uc153\udc0B\u9d6c\u3174\uF646\uAc89\u14E1\u163A\u6909\u70B6\ud0Ed\ucc42\u98A4\u285c\uF886";for(w=8;w-->0;){z[w]=[]}for(v=0;v<256;v++){G=y.charCodeAt(v/2);j=((v&1)==0)?G>>>8:G&255;h=j<<1;if(h>=256){h^=285}f=h<<1;if(f>=256){f^=285}e=f^j;M=f<<1;if(M>=256){M^=285}J=M^j;z[0][v]=[0,0];z[0][v][0]=(j<<24)|(j<<16)|(f<<8)|(j);z[0][v][1]=(M<<24)|(e<<16)|(h<<8)|(J);for(var w=1;w<8;w++){z[w][v]=[0,0];z[w][v][0]=(z[w-1][v][0]>>>8)|((z[w-1][v][1]<<24));z[w][v][1]=(z[w-1][v][1]>>>8)|((z[w-1][v][0]<<24))}}B[0]=[0,0];for(A=1;A<=m;A++){F=8*(A-1);B[A]=[0,0];B[A][0]=(z[0][F][0]&4278190080)^(z[1][F+1][0]&16711680)^(z[2][F+2][0]&65280)^(z[3][F+3][0]&255);B[A][1]=(z[4][F+4][1]&4278190080)^(z[5][F+5][1]&16711680)^(z[6][F+6][1]&65280)^(z[7][F+7][1]&255)}var E=[],D=[],q=0,n=0,g=[],s=[],p=[],o=[],l=[];var I=function(){var K,x,N,L,C;for(K=0,x=0;K<8;K++,x+=8){o[K]=[0,0];o[K][0]=((D[x]&255)<<24)^((D[x+1]&255)<<16)^((D[x+2]&255)<<8)^((D[x+3]&255));o[K][1]=((D[x+4]&255)<<24)^((D[x+5]&255)<<16)^((D[x+6]&255)<<8)^((D[x+7]&255))}for(K=0;K<8;K++){l[K]=[0,0];s[K]=[0,0];l[K][0]=o[K][0]^(s[K][0]=g[K][0]);l[K][1]=o[K][1]^(s[K][1]=g[K][1])}for(N=1;N<=m;N++){for(K=0;K<8;K++){p[K]=[0,0];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){p[K][0]^=z[C][(s[(K-C)&7][x]>>>(L%32))&255][0];p[K][1]^=z[C][(s[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){s[K][0]=p[K][0];s[K][1]=p[K][1]}s[0][0]^=B[N][0];s[0][1]^=B[N][1];for(K=0;K<8;K++){p[K][0]=s[K][0];p[K][1]=s[K][1];for(C=0,L=56,x=0;C<8;C++,L-=8,x=L<32?1:0){p[K][0]^=z[C][(l[(K-C)&7][x]>>>(L%32))&255][0];p[K][1]^=z[C][(l[(K-C)&7][x]>>>(L%32))&255][1]}}for(K=0;K<8;K++){l[K][0]=p[K][0];l[K][1]=p[K][1]}}for(K=0;K<8;K++){g[K][0]^=l[K][0]^o[K][0];g[K][1]^=l[K][1]^o[K][1]}};H=Whirlpool=function(i){return H.init().add(i).finalize()};H.version="3.0";H.init=function(){for(var r=32;r-->0;){E[r]=0}q=n=0;D=[0];for(r=8;r-->0;){g[r]=[0,0]}return H};H.add=function(L){if(!L){return H}var r=new Uint8Array(L);var Q=r.length*8;var t=0,x=(8-(Q&7))&7,K=q&7,C,N,P,O=Q;for(C=31,P=0;C>=0;C--){P+=(E[C]&255)+(O%256);E[C]=P&255;P>>>=8;O=Math.floor(O/256)}while(Q>8){N=((r[t]<<x)&255)|((r[t+1]&255)>>>(8-x));if(N<0||N>=256){return"Whirlpool requires a byte array"}D[n++]|=N>>>K;q+=8-K;if(q==512){I();q=n=0;D=[]}D[n]=((N<<(8-K))&255);q+=K;Q-=8;t++}if(Q>0){N=(r[t]<<x)&255;D[n]|=N>>>K}else{N=0}if(K+Q<8){q+=Q}else{n++;q+=8-K;Q-=8-K;if(q==512){I();q=n=0;D=[]}D[n]=((N<<(8-K))&255);q+=Q}return H};H.finalize=function(){var t,r,x,K="",C=[];D[n]|=128>>>(q&7);n++;if(n>32){while(n<64){D[n++]=0}I();n=0;D=[]}while(n<32){D[n++]=0}D.push.apply(D,E);I();for(t=0,r=0;t<8;t++,r+=8){x=g[t][0];C[r]=x>>>24&255;C[r+1]=x>>>16&255;C[r+2]=x>>>8&255;C[r+3]=x&255;x=g[t][1];C[r+4]=x>>>24&255;C[r+5]=x>>>16&255;C[r+6]=x>>>8&255;C[r+7]=x&255}return new Uint8Array(C).buffer};function u(){var i=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(r){return Whirlpool(r)};return this}k.set("hash.algorithms.whirlpool",u)})(a);(function(a7){var bc;var aQ=244837814094590;var aD=((aQ&16777215)==15715070);function aZ(bh,bg,bi){if(!(this instanceof aZ)){return new aZ(bh,bg,bi)}if(bh!=null){if("number"==typeof bh){this.fromNumber(bh,bg,bi)}else{if(bg==null&&"string"!=typeof bh){this.fromString(bh,256)}else{this.fromString(bh,bg)}}}}var a9=aZ.prototype;function p(){return new aZ(null)}function e(bk,bg,bh,bj,bm,bl){while(--bl>=0){var bi=bg*this[bk++]+bh[bj]+bm;bm=Math.floor(bi/67108864);bh[bj++]=bi&67108863}return bm}function be(bk,bp,bq,bj,bn,bg){var bm=bp&32767,bo=bp>>15;while(--bg>=0){var bi=this[bk]&32767;var bl=this[bk++]>>15;var bh=bo*bi+bl*bm;bi=bm*bi+((bh&32767)<<15)+bq[bj]+(bn&1073741823);bn=(bi>>>30)+(bh>>>15)+bo*bl+(bn>>>30);bq[bj++]=bi&1073741823}return bn}function bd(bk,bp,bq,bj,bn,bg){var bm=bp&16383,bo=bp>>14;while(--bg>=0){var bi=this[bk]&16383;var bl=this[bk++]>>14;var bh=bo*bi+bl*bm;bi=bm*bi+((bh&16383)<<14)+bq[bj]+bn;bn=(bi>>28)+(bh>>14)+bo*bl;bq[bj++]=bi&268435455}return bn}aZ.prototype.am=e;bc=26;aZ.prototype.DB=bc;aZ.prototype.DM=((1<<bc)-1);var am=aZ.prototype.DV=(1<<bc);var aE=52;aZ.prototype.FV=Math.pow(2,aE);aZ.prototype.F1=aE-bc;aZ.prototype.F2=2*bc-aE;var aM="0123456789abcdefghijklmnopqrstuvwxyz";var aP=new Array();var aX,E;aX="0".charCodeAt(0);for(E=0;E<=9;++E){aP[aX++]=E}aX="a".charCodeAt(0);for(E=10;E<36;++E){aP[aX++]=E}aX="A".charCodeAt(0);for(E=10;E<36;++E){aP[aX++]=E}function bf(bg){return aM.charAt(bg)}function O(bh,bg){var bi=aP[bh.charCodeAt(bg)];return(bi==null)?-1:bi}function aC(bh){for(var bg=this.t-1;bg>=0;--bg){bh[bg]=this[bg]}bh.t=this.t;bh.s=this.s}function y(bg){this.t=1;this.s=(bg<0)?-1:0;if(bg>0){this[0]=bg}else{if(bg<-1){this[0]=bg+am}else{this.t=0}}}function h(bg){var bh=p();bh.fromInt(bg);return bh}function H(bn,bh){var bk=this;var bj;if(bh==16){bj=4}else{if(bh==8){bj=3}else{if(bh==256){bj=8}else{if(bh==2){bj=1}else{if(bh==32){bj=5}else{if(bh==4){bj=2}else{bk.fromRadix(bn,bh);return}}}}}}bk.t=0;bk.s=0;var bm=bn.length,bi=false,bl=0;while(--bm>=0){var bg=(bj==8)?bn[bm]&255:O(bn,bm);if(bg<0){if(bn.charAt(bm)=="-"){bi=true}continue}bi=false;if(bl==0){bk[bk.t++]=bg}else{if(bl+bj>bk.DB){bk[bk.t-1]|=(bg&((1<<(bk.DB-bl))-1))<<bl;bk[bk.t++]=(bg>>(bk.DB-bl))}else{bk[bk.t-1]|=bg<<bl}}bl+=bj;if(bl>=bk.DB){bl-=bk.DB}}if(bj==8&&(bn[0]&128)!=0){bk.s=-1;if(bl>0){bk[bk.t-1]|=((1<<(bk.DB-bl))-1)<<bl}}bk.clamp();if(bi){aZ.ZERO.subTo(bk,bk)}}function ah(){var bg=this.s&this.DM;while(this.t>0&&this[this.t-1]==bg){--this.t}}function A(bn){var bo=this;if(bo.s<0){return"-"+bo.negate().toString(bn)}var bk;if(bn==16){bk=4}else{if(bn==8){bk=3}else{if(bn==2){bk=1}else{if(bn==32){bk=5}else{if(bn==4){bk=2}else{return bo.toRadix(bn)}}}}}var bh=(1<<bk)-1,bm,bj=false,bg="",bl=bo.t;var bi=bo.DB-(bl*bo.DB)%bk;if(bl-->0){if(bi<bo.DB&&(bm=bo[bl]>>bi)>0){bj=true;bg=bf(bm)}while(bl>=0){if(bi<bk){bm=(bo[bl]&((1<<bi)-1))<<(bk-bi);bm|=bo[--bl]>>(bi+=bo.DB-bk)}else{bm=(bo[bl]>>(bi-=bk))&bh;if(bi<=0){bi+=bo.DB;--bl}}if(bm>0){bj=true}if(bj){bg+=bf(bm)}}}return bj?bg:"0"}function al(){var bg=p();aZ.ZERO.subTo(this,bg);return bg}function aT(){return(this.s<0)?this.negate():this}function Y(bg){var bi=this.s-bg.s;if(bi!=0){return bi}var bh=this.t;bi=bh-bg.t;if(bi!=0){return(this.s<0)?-bi:bi}while(--bh>=0){if((bi=this[bh]-bg[bh])!=0){return bi}}return 0}function u(bg){var bi=1,bh;if((bh=bg>>>16)!=0){bg=bh;bi+=16}if((bh=bg>>8)!=0){bg=bh;bi+=8}if((bh=bg>>4)!=0){bg=bh;bi+=4}if((bh=bg>>2)!=0){bg=bh;bi+=2}if((bh=bg>>1)!=0){bg=bh;bi+=1}return bi}function D(){if(this.t<=0){return 0}return this.DB*(this.t-1)+u(this[this.t-1]^(this.s&this.DM))}function aY(bi,bh){var bg;for(bg=this.t-1;bg>=0;--bg){bh[bg+bi]=this[bg]}for(bg=bi-1;bg>=0;--bg){bh[bg]=0}bh.t=this.t+bi;bh.s=this.s}function aB(bi,bh){for(var bg=bi;bg<this.t;++bg){bh[bg-bi]=this[bg]}bh.t=Math.max(this.t-bi,0);bh.s=this.s}function C(bi,bg){var bp=this;var bo=bi%bp.DB;var bl=bp.DB-bo;var bh=(1<<bl)-1;var bj=Math.floor(bi/bp.DB),bn=(bp.s<<bo)&bp.DM,bk;for(bk=bp.t-1;bk>=0;--bk){bg[bk+bj+1]=(bp[bk]>>bl)|bn;bn=(bp[bk]&bh)<<bo}for(bk=bj-1;bk>=0;--bk){bg[bk]=0}bg[bj]=bn;bg.t=bp.t+bj+1;bg.s=bp.s;bg.clamp()}function v(bo,bk){var bg=this;bk.s=bg.s;var bl=Math.floor(bo/bg.DB);if(bl>=bg.t){bk.t=0;return}var bi=bo%bg.DB;var bh=bg.DB-bi;var bn=(1<<bi)-1;bk[0]=bg[bl]>>bi;for(var bj=bl+1;bj<bg.t;++bj){bk[bj-bl-1]|=(bg[bj]&bn)<<bh;bk[bj-bl]=bg[bj]>>bi}if(bi>0){bk[bg.t-bl-1]|=(bg.s&bn)<<bh}bk.t=bg.t-bl;bk.clamp()}function aF(bh,bk){var bi=this;var bj=0,bl=0,bg=Math.min(bh.t,bi.t);while(bj<bg){bl+=bi[bj]-bh[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}if(bh.t<bi.t){bl-=bh.s;while(bj<bi.t){bl+=bi[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}bl+=bi.s}else{bl+=bi.s;while(bj<bh.t){bl-=bh[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}bl-=bh.s}bk.s=(bl<0)?-1:0;if(bl<-1){bk[bj++]=bi.DV+bl}else{if(bl>0){bk[bj++]=bl}}bk.t=bj;bk.clamp()}function T(bh,bj){var bg=this.abs(),bk=bh.abs();var bi=bg.t;bj.t=bi+bk.t;while(--bi>=0){bj[bi]=0}for(bi=0;bi<bk.t;++bi){bj[bi+bg.t]=bg.am(0,bk[bi],bj,bi,0,bg.t)}bj.s=0;bj.clamp();if(this.s!=bh.s){aZ.ZERO.subTo(bj,bj)}}function aj(bi){var bg=this.abs();var bh=bi.t=2*bg.t;while(--bh>=0){bi[bh]=0}for(bh=0;bh<bg.t-1;++bh){var bj=bg.am(bh,bg[bh],bi,2*bh,0,1);if((bi[bh+bg.t]+=bg.am(bh+1,2*bg[bh],bi,2*bh+1,bj,bg.t-bh-1))>=bg.DV){bi[bh+bg.t]-=bg.DV;bi[bh+bg.t+1]=1}}if(bi.t>0){bi[bi.t-1]+=bg.am(bh,bg[bh],bi,2*bh,0,1)}bi.s=0;bi.clamp()}function U(bq,bn,bl){var bm=this;var bw=bq.abs();if(bw.t<=0){return}var bo=bm.abs();if(bo.t<bw.t){if(bn!=null){bn.fromInt(0)}if(bl!=null){bm.copyTo(bl)}return}if(bl==null){bl=p()}var bj=p(),bg=bm.s,bp=bq.s;var bv=bm.DB-u(bw[bw.t-1]);if(bv>0){bw.lShiftTo(bv,bj);bo.lShiftTo(bv,bl)}else{bw.copyTo(bj);bo.copyTo(bl)}var bt=bj.t;var bh=bj[bt-1];if(bh==0){return}var br=bh*(1<<bm.F1)+((bt>1)?bj[bt-2]>>bm.F2:0);var bz=bm.FV/br,by=(1<<bm.F1)/br,bx=1<<bm.F2;var bu=bl.t,bs=bu-bt,bk=(bn==null)?p():bn;bj.dlShiftTo(bs,bk);if(bl.compareTo(bk)>=0){bl[bl.t++]=1;bl.subTo(bk,bl)}aZ.ONE.dlShiftTo(bt,bk);bk.subTo(bj,bj);while(bj.t<bt){bj[bj.t++]=0}while(--bs>=0){var bi=(bl[--bu]==bh)?bm.DM:Math.floor(bl[bu]*bz+(bl[bu-1]+bx)*by);if((bl[bu]+=bj.am(0,bi,bl,bs,0,bt))<bi){bj.dlShiftTo(bs,bk);bl.subTo(bk,bl);while(bl[bu]<--bi){bl.subTo(bk,bl)}}}if(bn!=null){bl.drShiftTo(bt,bn);if(bg!=bp){aZ.ZERO.subTo(bn,bn)}}bl.t=bt;bl.clamp();if(bv>0){bl.rShiftTo(bv,bl)}if(bg<0){aZ.ZERO.subTo(bl,bl)}}function ag(bg){var bh=p();this.abs().divRemTo(bg,null,bh);if(this.s<0&&bh.compareTo(aZ.ZERO)>0){bg.subTo(bh,bh)}return bh}function ac(bg){this.m=bg}function ax(bg){if(bg.s<0||bg.compareTo(this.m)>=0){return bg.mod(this.m)}else{return bg}}function aS(bg){return bg}function aa(bg){bg.divRemTo(this.m,null,bg)}function Z(bg,bi,bh){bg.multiplyTo(bi,bh);this.reduce(bh)}function a4(bg,bh){bg.squareTo(bh);this.reduce(bh)}ac.prototype.convert=ax;ac.prototype.revert=aS;ac.prototype.reduce=aa;ac.prototype.mulTo=Z;ac.prototype.sqrTo=a4;function Q(){if(this.t<1){return 0}var bg=this[0];if((bg&1)==0){return 0}var bh=bg&3;bh=(bh*(2-(bg&15)*bh))&15;bh=(bh*(2-(bg&255)*bh))&255;bh=(bh*(2-(((bg&65535)*bh)&65535)))&65535;bh=(bh*(2-bg*bh%this.DV))%this.DV;return(bh>0)?this.DV-bh:-bh}function l(bg){this.m=bg;this.mp=bg.invDigit();this.mpl=this.mp&32767;this.mph=this.mp>>15;this.um=(1<<(bg.DB-15))-1;this.mt2=2*bg.t}function aR(bg){var bh=p();bg.abs().dlShiftTo(this.m.t,bh);bh.divRemTo(this.m,null,bh);if(bg.s<0&&bh.compareTo(aZ.ZERO)>0){this.m.subTo(bh,bh)}return bh}function a2(bg){var bh=p();bg.copyTo(bh);this.reduce(bh);return bh}function ai(bg){while(bg.t<=this.mt2){bg[bg.t++]=0}for(var bi=0;bi<this.m.t;++bi){var bh=bg[bi]&32767;var bj=(bh*this.mpl+(((bh*this.mph+(bg[bi]>>15)*this.mpl)&this.um)<<15))&bg.DM;bh=bi+this.m.t;bg[bh]+=this.m.am(0,bj,bg,bi,0,this.m.t);while(bg[bh]>=bg.DV){bg[bh]-=bg.DV;bg[++bh]++}}bg.clamp();bg.drShiftTo(this.m.t,bg);if(bg.compareTo(this.m)>=0){bg.subTo(this.m,bg)}}function aU(bg,bh){bg.squareTo(bh);this.reduce(bh)}function N(bg,bi,bh){bg.multiplyTo(bi,bh);this.reduce(bh)}l.prototype.convert=aR;l.prototype.revert=a2;l.prototype.reduce=ai;l.prototype.mulTo=N;l.prototype.sqrTo=aU;function q(){return((this.t>0)?(this[0]&1):this.s)==0}function I(bl,bm){if(bl>4294967295||bl<1){return aZ.ONE}var bk=p(),bg=p(),bj=bm.convert(this),bi=u(bl)-1;bj.copyTo(bk);while(--bi>=0){bm.sqrTo(bk,bg);if((bl&(1<<bi))>0){bm.mulTo(bg,bj,bk)}else{var bh=bk;bk=bg;bg=bh}}return bm.revert(bk)}function aW(bh,bg){var bi;if(bh<256||bg.isEven()){bi=new ac(bg)}else{bi=new l(bg)}return this.exp(bh,bi)}a9.copyTo=aC;a9.fromInt=y;a9.fromString=H;a9.clamp=ah;a9.dlShiftTo=aY;a9.drShiftTo=aB;a9.lShiftTo=C;a9.rShiftTo=v;a9.subTo=aF;a9.multiplyTo=T;a9.squareTo=aj;a9.divRemTo=U;a9.invDigit=Q;a9.isEven=q;a9.exp=I;a9.toString=A;a9.negate=al;a9.abs=aT;a9.compareTo=Y;a9.bitLength=D;a9.mod=ag;a9.modPowInt=aW;function p(){return new aZ(null)}function n(){var bg=p();this.copyTo(bg);return bg}function W(){if(this.s<0){if(this.t==1){return this[0]-this.DV}else{if(this.t==0){return -1}}}else{if(this.t==1){return this[0]}else{if(this.t==0){return 0}}}return((this[1]&((1<<(32-this.DB))-1))<<this.DB)|this[0]}function aN(){return(this.t==0)?this.s:(this[0]<<24)>>24}function ak(){return(this.t==0)?this.s:(this[0]<<16)>>16}function aA(bg){return Math.floor(Math.LN2*this.DB/Math.log(bg))}function a0(){if(this.s<0){return -1}else{if(this.t<=0||(this.t==1&&this[0]<=0)){return 0}else{return 1}}}function L(bg){if(bg==null){bg=10}if(this.signum()==0||bg<2||bg>36){return"0"}var bi=this.chunkSize(bg);var bh=Math.pow(bg,bi);var bl=h(bh),bm=p(),bk=p(),bj="";this.divRemTo(bl,bm,bk);while(bm.signum()>0){bj=(bh+bk.intValue()).toString(bg).substr(1)+bj;bm.divRemTo(bl,bm,bk)}return bk.intValue().toString(bg)+bj}function aq(bp,bl){var bo=this;bo.fromInt(0);if(bl==null){bl=10}var bj=bo.chunkSize(bl);var bk=Math.pow(bl,bj),bi=false,bg=0,bn=0;for(var bh=0;bh<bp.length;++bh){var bm=O(bp,bh);if(bm<0){if(bp.charAt(bh)=="-"&&bo.signum()==0){bi=true}continue}bn=bl*bn+bm;if(++bg>=bj){bo.dMultiply(bk);bo.dAddOffset(bn,0);bg=0;bn=0}}if(bg>0){bo.dMultiply(Math.pow(bl,bg));bo.dAddOffset(bn,0)}if(bi){aZ.ZERO.subTo(bo,bo)}}function aK(bi,bh,bl){var bj=this;if("number"==typeof bh){if(bi<2){bj.fromInt(1)}else{bj.fromNumber(bi,bl);if(!bj.testBit(bi-1)){bj.bitwiseTo(aZ.ONE.shiftLeft(bi-1),ad,bj)}if(bj.isEven()){bj.dAddOffset(1,0)}while(!bj.isProbablePrime(bh)){bj.dAddOffset(2,0);if(bj.bitLength()>bi){bj.subTo(aZ.ONE.shiftLeft(bi-1),bj)}}}}else{var bg=new Array(),bk=bi&7;bg.length=(bi>>3)+1;bh.nextBytes(bg);if(bk>0){bg[0]&=((1<<bk)-1)}else{bg[0]=0}bj.fromString(bg,256)}}function a8(){var bh=this;var bi=bh.t,bj=new Array();bj[0]=bh.s;var bk=bh.DB-(bi*bh.DB)%8,bl,bg=0;if(bi-->0){if(bk<bh.DB&&(bl=bh[bi]>>bk)!=(bh.s&bh.DM)>>bk){bj[bg++]=bl|(bh.s<<(bh.DB-bk))}while(bi>=0){if(bk<8){bl=(bh[bi]&((1<<bk)-1))<<(8-bk);bl|=bh[--bi]>>(bk+=bh.DB-8)}else{bl=(bh[bi]>>(bk-=8))&255;if(bk<=0){bk+=bh.DB;--bi}}if((bl&128)!=0){bl|=-256}if(bg===0&&(bh.s&128)!=(bl&128)){++bg}if(bg>0||bl!=bh.s){bj[bg++]=bl}}}return bj}function ao(bg){return(this.compareTo(bg)==0)}function X(bg){return(this.compareTo(bg)<0)?this:bg}function av(bg){return(this.compareTo(bg)>0)?this:bg}function aL(bh,bm,bk){var bi=this;var bj,bl,bg=Math.min(bh.t,bi.t);for(bj=0;bj<bg;++bj){bk[bj]=bm(bi[bj],bh[bj])}if(bh.t<bi.t){bl=bh.s&bi.DM;for(bj=bg;bj<bi.t;++bj){bk[bj]=bm(bi[bj],bl)}bk.t=bi.t}else{bl=bi.s&bi.DM;for(bj=bg;bj<bh.t;++bj){bk[bj]=bm(bl,bh[bj])}bk.t=bh.t}bk.s=bm(bi.s,bh.s);bk.clamp()}function M(bg,bh){return bg&bh}function bb(bg){var bh=p();this.bitwiseTo(bg,M,bh);return bh}function ad(bg,bh){return bg|bh}function az(bg){var bh=p();this.bitwiseTo(bg,ad,bh);return bh}function R(bg,bh){return bg^bh}function j(bg){var bh=p();this.bitwiseTo(bg,R,bh);return bh}function F(bg,bh){return bg&~bh}function w(bg){var bh=p();this.bitwiseTo(bg,F,bh);return bh}function S(){var bh=p();for(var bg=0;bg<this.t;++bg){bh[bg]=this.DM&~this[bg]}bh.t=this.t;bh.s=~this.s;return bh}function G(bh){var bg=p();if(bh<0){this.rShiftTo(-bh,bg)}else{this.lShiftTo(bh,bg)}return bg}function ba(bh){var bg=p();if(bh<0){this.lShiftTo(-bh,bg)}else{this.rShiftTo(bh,bg)}return bg}function s(bg){if(bg==0){return -1}var bh=0;if((bg&65535)==0){bg>>=16;bh+=16}if((bg&255)==0){bg>>=8;bh+=8}if((bg&15)==0){bg>>=4;bh+=4}if((bg&3)==0){bg>>=2;bh+=2}if((bg&1)==0){++bh}return bh}function z(){for(var bg=0;bg<this.t;++bg){if(this[bg]!=0){return bg*this.DB+s(this[bg])}}if(this.s<0){return this.t*this.DB}return -1}function aV(bg){var bh=0;while(bg!=0){bg&=bg-1;++bh}return bh}function aJ(){var bi=0,bg=this.s&this.DM;for(var bh=0;bh<this.t;++bh){bi+=aV(this[bh]^bg)}return bi}function aH(bh){var bg=Math.floor(bh/this.DB);if(bg>=this.t){return(this.s!=0)}return((this[bg]&(1<<(bh%this.DB)))!=0)}function V(bi,bh){var bg=aZ.ONE.shiftLeft(bi);this.bitwiseTo(bg,bh,bg);return bg}function P(bg){return this.changeBit(bg,ad)}function x(bg){return this.changeBit(bg,F)}function g(bg){return this.changeBit(bg,R)}function ar(bh,bk){var bi=this;var bj=0,bl=0,bg=Math.min(bh.t,bi.t);while(bj<bg){bl+=bi[bj]+bh[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}if(bh.t<bi.t){bl+=bh.s;while(bj<bi.t){bl+=bi[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}bl+=bi.s}else{bl+=bi.s;while(bj<bh.t){bl+=bh[bj];bk[bj++]=bl&bi.DM;bl>>=bi.DB}bl+=bh.s}bk.s=(bl<0)?-1:0;if(bl>0){bk[bj++]=bl}else{if(bl<-1){bk[bj++]=bi.DV+bl}}bk.t=bj;bk.clamp()}function au(bg){var bh=p();this.addTo(bg,bh);return bh}function a1(bg){var bh=p();this.subTo(bg,bh);return bh}function an(bg){var bh=p();this.multiplyTo(bg,bh);return bh}function aG(){var bg=p();this.squareTo(bg);return bg}function i(bg){var bh=p();this.divRemTo(bg,bh,null);return bh}function m(bg){var bh=p();this.divRemTo(bg,null,bh);return bh}function aI(bg){var bi=p(),bh=p();this.divRemTo(bg,bi,bh);return new Array(bi,bh)}function r(bg){this[this.t]=this.am(0,bg-1,this,0,0,this.t);++this.t;this.clamp()}function af(bh,bg){if(bh==0){return}while(this.t<=bg){this[this.t++]=0}this[bg]+=bh;while(this[bg]>=this.DV){this[bg]-=this.DV;if(++bg>=this.t){this[this.t++]=0}++this[bg]}}function at(){}function aO(bg){return bg}function t(bg,bi,bh){bg.multiplyTo(bi,bh)}function ay(bg,bh){bg.squareTo(bh)}at.prototype.convert=aO;at.prototype.revert=aO;at.prototype.mulTo=t;at.prototype.sqrTo=ay;function J(bg){return this.exp(bg,new at())}function o(bg,bk,bj){var bi=Math.min(this.t+bg.t,bk);bj.s=0;bj.t=bi;while(bi>0){bj[--bi]=0}var bh;for(bh=bj.t-this.t;bi<bh;++bi){bj[bi+this.t]=this.am(0,bg[bi],bj,bi,0,this.t)}for(bh=Math.min(bg.t,bk);bi<bh;++bi){this.am(0,bg[bi],bj,bi,0,bk-bi)}bj.clamp()}function k(bg,bj,bi){--bj;var bh=bi.t=this.t+bg.t-bj;bi.s=0;while(--bh>=0){bi[bh]=0}for(bh=Math.max(bj-this.t,0);bh<bg.t;++bh){bi[this.t+bh-bj]=this.am(bj-bh,bg[bh],bi,0,0,this.t+bh-bj)}bi.clamp();bi.drShiftTo(1,bi)}function K(bg){this.r2=p();this.q3=p();aZ.ONE.dlShiftTo(2*bg.t,this.r2);this.mu=this.r2.divide(bg);this.m=bg}function ab(bg){if(bg.s<0||bg.t>2*this.m.t){return bg.mod(this.m)}else{if(bg.compareTo(this.m)<0){return bg}else{var bh=p();bg.copyTo(bh);this.reduce(bh);return bh}}}function ae(bg){return bg}function a5(bg){var bh=this;bg.drShiftTo(bh.m.t-1,bh.r2);if(bg.t>bh.m.t+1){bg.t=bh.m.t+1;bg.clamp()}bh.mu.multiplyUpperTo(bh.r2,bh.m.t+1,bh.q3);bh.m.multiplyLowerTo(bh.q3,bh.m.t+1,bh.r2);while(bg.compareTo(bh.r2)<0){bg.dAddOffset(1,bh.m.t+1)}bg.subTo(bh.r2,bg);while(bg.compareTo(bh.m)>=0){bg.subTo(bh.m,bg)}}function ap(bg,bh){bg.squareTo(bh);this.reduce(bh)}function a6(bg,bi,bh){bg.multiplyTo(bi,bh);this.reduce(bh)}K.prototype.convert=ab;K.prototype.revert=ae;K.prototype.reduce=a5;K.prototype.mulTo=a6;K.prototype.sqrTo=ap;function aw(bp,bk){var bn=bp.bitLength(),bl,bh=h(1),bs;if(bn<=0){return bh}else{if(bn<18){bl=1}else{if(bn<48){bl=3}else{if(bn<144){bl=4}else{if(bn<768){bl=5}else{bl=6}}}}}if(bn<8){bs=new ac(bk)}else{if(bk.isEven()){bs=new K(bk)}else{bs=new l(bk)}}var bo=new Array(),bj=3,bq=bl-1,bg=(1<<bl)-1;bo[1]=bs.convert(this);if(bl>1){var bv=p();bs.sqrTo(bo[1],bv);while(bj<=bg){bo[bj]=p();bs.mulTo(bv,bo[bj-2],bo[bj]);bj+=2}}var bm=bp.t-1,bt,br=true,bi=p(),bu;bn=u(bp[bm])-1;while(bm>=0){if(bn>=bq){bt=(bp[bm]>>(bn-bq))&bg}else{bt=(bp[bm]&((1<<(bn+1))-1))<<(bq-bn);if(bm>0){bt|=bp[bm-1]>>(this.DB+bn-bq)}}bj=bl;while((bt&1)==0){bt>>=1;--bj}if((bn-=bj)<0){bn+=this.DB;--bm}if(br){bo[bt].copyTo(bh);br=false}else{while(bj>1){bs.sqrTo(bh,bi);bs.sqrTo(bi,bh);bj-=2}if(bj>0){bs.sqrTo(bh,bi)}else{bu=bh;bh=bi;bi=bu}bs.mulTo(bi,bo[bt],bh)}while(bm>=0&&(bp[bm]&(1<<bn))==0){bs.sqrTo(bh,bi);bu=bh;bh=bi;bi=bu;if(--bn<0){bn=this.DB-1;--bm}}}return bs.revert(bh)}function a3(bh){var bg=(this.s<0)?this.negate():this.clone();var bl=(bh.s<0)?bh.negate():bh.clone();if(bg.compareTo(bl)<0){var bj=bg;bg=bl;bl=bj}var bi=bg.getLowestSetBit(),bk=bl.getLowestSetBit();if(bk<0){return bg}if(bi<bk){bk=bi}if(bk>0){bg.rShiftTo(bk,bg);bl.rShiftTo(bk,bl)}while(bg.signum()>0){if((bi=bg.getLowestSetBit())>0){bg.rShiftTo(bi,bg)}if((bi=bl.getLowestSetBit())>0){bl.rShiftTo(bi,bl)}if(bg.compareTo(bl)>=0){bg.subTo(bl,bg);bg.rShiftTo(1,bg)}else{bl.subTo(bg,bl);bl.rShiftTo(1,bl)}}if(bk>0){bl.lShiftTo(bk,bl)}return bl}function B(bj){if(bj<=0){return 0}var bi=this.DV%bj,bh=(this.s<0)?bj-1:0;if(this.t>0){if(bi==0){bh=this[0]%bj}else{for(var bg=this.t-1;bg>=0;--bg){bh=(bi*bh+this[bg])%bj}}}return bh}function f(bh){var bl=bh.isEven();if((this.isEven()&&bl)||bh.signum()==0){return aZ.ZERO}var bk=bh.clone(),bj=this.clone();var bi=h(1),bg=h(0),bn=h(0),bm=h(1);while(bk.signum()!=0){while(bk.isEven()){bk.rShiftTo(1,bk);if(bl){if(!bi.isEven()||!bg.isEven()){bi.addTo(this,bi);bg.subTo(bh,bg)}bi.rShiftTo(1,bi)}else{if(!bg.isEven()){bg.subTo(bh,bg)}}bg.rShiftTo(1,bg)}while(bj.isEven()){bj.rShiftTo(1,bj);if(bl){if(!bn.isEven()||!bm.isEven()){bn.addTo(this,bn);bm.subTo(bh,bm)}bn.rShiftTo(1,bn)}else{if(!bm.isEven()){bm.subTo(bh,bm)}}bm.rShiftTo(1,bm)}if(bk.compareTo(bj)>=0){bk.subTo(bj,bk);if(bl){bi.subTo(bn,bi)}bg.subTo(bm,bg)}else{bj.subTo(bk,bj);if(bl){bn.subTo(bi,bn)}bm.subTo(bg,bm)}}if(bj.compareTo(aZ.ONE)!=0){return aZ.ZERO}if(bm.compareTo(bh)>=0){return bm.subtract(bh)}if(bm.signum()<0){bm.addTo(bh,bm)}else{return bm}if(bm.signum()<0){return bm.add(bh)}else{return bm}}a9.chunkSize=aA;a9.toRadix=L;a9.fromRadix=aq;a9.fromNumber=aK;a9.bitwiseTo=aL;a9.changeBit=V;a9.addTo=ar;a9.dMultiply=r;a9.dAddOffset=af;a9.multiplyLowerTo=o;a9.multiplyUpperTo=k;a9.modInt=B;a9.clone=n;a9.intValue=W;a9.byteValue=aN;a9.shortValue=ak;a9.signum=a0;a9.toByteArray=a8;a9.equals=ao;a9.min=X;a9.max=av;a9.and=bb;a9.or=az;a9.xor=j;a9.andNot=w;a9.not=S;a9.shiftLeft=G;a9.shiftRight=ba;a9.getLowestSetBit=z;a9.bitCount=aJ;a9.testBit=aH;a9.setBit=P;a9.clearBit=x;a9.flipBit=g;a9.add=au;a9.subtract=a1;a9.multiply=an;a9.divide=i;a9.remainder=m;a9.divideAndRemainder=aI;a9.modPow=aw;a9.modInverse=f;a9.pow=J;a9.gcd=a3;a9.square=aG;aZ.ZERO=h(0);aZ.ONE=h(1);aZ.valueOf=h;aZ.fromByteArrayUnsigned=function(bg){if(!bg.length){return new aZ.valueOf(0)}else{if(bg[0]&128){return new aZ([0].concat(bg))}else{return new aZ(bg)}}};aZ.fromByteArraySigned=function(bg){if(bg[0]&128){bg[0]&=127;return aZ.fromByteArrayUnsigned(bg).negate()}else{return aZ.fromByteArrayUnsigned(bg)}};aZ.prototype.toByteArrayUnsigned=function(){var bh=this.abs().toByteArray();if(!bh.length){return bh}if(bh[0]===0){bh=bh.slice(1)}for(var bg=0;bg<bh.length;++bg){bh[bg]=(bh[bg]<0)?bh[bg]+256:bh[bg]}return bh};aZ.prototype.toByteArraySigned=function(){var bg=this.toByteArrayUnsigned();var bh=this.s<0;if(bg[0]&128){bg.unshift((bh)?128:0)}else{if(bh){bg[0]|=128}}return bg};a7.set("cipher.asymmetric.ec.bigi",aZ)})(a);(function(f){function e(k,j){var g=k.ECPointFp;function h(t,p,s,o){var n=Math.max(p.bitLength(),o.bitLength());var u=t.add2D(s);var r=t.curve.getInfinity();for(var q=n-1;q>=0;--q){r=r.twice2D();r.z=j.ONE;if(p.testBit(q)){if(o.testBit(q)){r=r.add2D(u)}else{r=r.add2D(t)}}else{if(o.testBit(q)){r=r.add2D(s)}}}return r}function i(s){var u=this;var t=null;var r=new f.get("util.srand")();var l={nextBytes:function(v){var x=r.bytes(v.length);for(var w=0;w<x.length;++w){v[w]=x[w]}}};this.sign=function(y,D){var B=D;var w=s.getN();var A=j.fromByteArrayUnsigned(y);var x=p(w);var C=s.getG();var z=C.multiply(x);var v=z.getX().toBigInteger().mod(w);var E=x.modInverse(w).multiply(A.add(B.multiply(v))).mod(w);if(E.compareTo(w.divide(j.valueOf(2)))>0){E=w.subtract(E)}return m(v,E)};this.verify=function(B,C,w){var y,v;if(Array.isArray(C)){var A=o(C);y=A.r;v=A.s}else{throw new Error("Invalid value for signature")}var x;if(w instanceof g){x=w}else{if(Array.isArray(w)){x=g.decodeFrom(s.getCurve(),w)}else{throw new Error("Invalid format for pubkey value, must be byte array or ECPointFp")}}var z=j.fromByteArrayUnsigned(B);return q(z,y,v,x)};function q(B,w,H,A){var z=s.getN();var F=s.getG();if(w.compareTo(j.ONE)<0||w.compareTo(z)>=0){return false}if(H.compareTo(j.ONE)<0||H.compareTo(z)>=0){return false}var C=H.modInverse(z);var y=B.multiply(C).mod(z);var x=w.multiply(C).mod(z);var D=F.multiply(y).add(A.multiply(x));var E=D.getX().toBigInteger().mod(z);return E.equals(w)}function n(y){if(y.length!==65){throw new Error("Signature has the wrong length")}var v=y[0]-27;if(v<0||v>7){throw new Error("Invalid signature type")}var z=s.getN();var x=j.fromByteArrayUnsigned(y.slice(1,33)).mod(z);var w=j.fromByteArrayUnsigned(y.slice(33,65)).mod(z);return{r:x,s:w,i:v}}function p(v){return new j(v.bitLength(),l).mod(v.subtract(j.ONE)).add(j.ONE)}function m(x,w){var y=x.toByteArraySigned();var v=w.toByteArraySigned();var z=[];z.push(2);z.push(y.length);z=z.concat(y);z.push(2);z.push(v.length);z=z.concat(v);z.unshift(z.length);z.unshift(48);return z}function o(A){var z;if(A[0]!=48){throw new Error("Signature not a valid DERSequence")}z=2;if(A[z]!=2){throw new Error("First element in signature must be a DERInteger")}var y=A.slice(z+2,z+2+A[z+1]);z+=2+A[z+1];if(A[z]!=2){throw new Error("Second element in signature must be a DERInteger")}var v=A.slice(z+2,z+2+A[z+1]);z+=2+A[z+1];var x=j.fromByteArrayUnsigned(y);var w=j.fromByteArrayUnsigned(v);return{r:x,s:w}}return this}return i}f.set("cipher.asymmetric.ec.ecdsa",function(h){var g=e(f.get("cipher.asymmetric.ec.ecurve"),f.get("cipher.asymmetric.ec.bigi"));return new g(h)})})(a);(function(e){function f(m){var q=this;var l=e.get("cipher.asymmetric.ec.ecparams"),i=e.get("cipher.asymmetric.ec.ecdsa"),n=e.get("cipher.asymmetric.ec.ecurve"),k=e.get("cipher.asymmetric.ec.bigi");var x=null,w=null;var y=l(m);if(!y){throw Error("unknown-ec-curve-name")}var p=i(y);function t(B){var C=new Array(B.length);for(var A=0;A<C.length;A++){C[A]=B[A]}return C}this.setPrivateKey=function(A){v(e.get("util.encoding")(A).toArray())};this.setPublicKey=function(A){s(e.get("util.encoding")(A).toArray())};function u(A){if(A){q.sign=z;q.decrypt=j;q._computeSecret=o}q.verify=h;q.encrypt=r;q.getPublicKey=function(){return new Uint8Array(w).buffer};delete q.setPrivateKey;delete q.setPublicKey}function s(A){x=null;w=A;u(false)}function v(B){x=k.fromByteArrayUnsigned(B);var A=y.getG().multiply(x);w=A.getEncoded(false);u(true)}function z(B){if(!e.get("util.type")(B).isArrayBuffer()){throw new Error("invalid-parameter")}var A=p.sign(e.get("util.encoding")(B).toArray(),x);return e.get("util.encoding")(A).toArrayBuffer()}function h(B,D){if(!(e.get("util.type")(B).isArrayBuffer()&&e.get("util.type")(D).isArrayBuffer())){throw new Error("invalid-parameter")}try{var E=e.get("util.encoding")(D).toArray(),F=e.get("util.encoding")(B).toArray();var A=p.verify(F,E,w)}catch(C){console.log(C);return false}return A}function o(B){if(!e.get("util.type")(B).isArrayBuffer()){throw Error("invalid-parameter")}var A=e.get("util.encoding")(B).toArray();var D=n.ECPointFp.decodeFrom(y.getCurve(),A);var C=D.multiply(x);var E=C.getEncoded().slice(1);return e.get("util.encoding")(E).toArrayBuffer()}function r(D){if(!e.get("util.type")(D).isArrayBuffer()){throw new Error("invalid-parameter")}var C=new f(m);C.setPrivateKey(new e.get("util.srand")().bytes(64));var G=C._computeSecret(q.getPublicKey()),F=C.getPublicKey();var A=new e.get("cipher.symmetric")().key(G),E=A.encrypt(D);var B=new Uint16Array([F.byteLength]);return e.get("util.buffer").concat([B.buffer,F,E])}function j(E){if(!(e.get("util.type")(E).isArrayBuffer()&&E.byteLength>2)){throw new Error("invalid-parameter")}var A=E.slice(0,2),E=E.slice(2);var C=new Uint16Array(A)[0];if(E.length<=C){throw new Error("invalid-ciphertext")}var H=E.slice(0,C),F=E.slice(C);var G=o(H);var D=new e.get("cipher.symmetric")().key(G);var B=D.decrypt(F);return B}return this}var g={name:"EC",constructor:function(h){return new f(h.curve)}};e.set("cipher.asymmetric.ec",g)})(a);(function(m){var g,e;"use strict";function o(r,q,s,p){this.curve=r;this.g=q;this.n=s;this.h=p}o.prototype.getCurve=function n(){return this.curve};o.prototype.getG=function l(){return this.g};o.prototype.getN=function h(){return this.n};o.prototype.getH=function j(){return this.h};function k(p){p=p.replace(/[^0-9a-f]/ig,"").toUpperCase();return new g(p,16)}var i={secp128r1:function(){var u=k("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFF");var r=k("FFFFFFFDFFFFFFFFFFFFFFFFFFFFFFFC");var q=k("E87579C11079F43DD824993C2CEE5ED3");var w=k("FFFFFFFE0000000075A30D1B9038A115");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("04161FF7528B899B2D0C28607CA52C5B86CF5AC8395BAFEB13C02DA292DDED7A83");return new o(v,s,w,t)},secp160k1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFAC73");var r=g.ZERO;var q=k("7");var w=k("0100000000000000000001B8FA16DFAB9ACA16B6B3");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("043B4C382CE37AA192A4019E763036F4F5DD4D7EBB938CF935318FDCED6BC28286531733C3F03C4FEE");return new o(v,s,w,t)},secp160r1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFF");var r=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF7FFFFFFC");var q=k("1C97BEFC54BD7A8B65ACF89F81D4D4ADC565FA45");var w=k("0100000000000000000001F4C8F927AED3CA752257");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("044A96B5688EF573284664698968C38BB913CBFC8223A628553168947D59DCC912042351377AC5FB32");return new o(v,s,w,t)},secp192k1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFEE37");var r=g.ZERO;var q=k("3");var w=k("FFFFFFFFFFFFFFFFFFFFFFFE26F2FC170F69466A74DEFD8D");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("04DB4FF10EC057E9AE26B07D0280B7F4341DA5D1B1EAE06C7D9B2F2F6D9C5628A7844163D015BE86344082AA88D95E2F9D");return new o(v,s,w,t)},secp192r1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFF");var r=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFC");var q=k("64210519E59C80E70FA7E9AB72243049FEB8DEECC146B9B1");var w=k("FFFFFFFFFFFFFFFFFFFFFFFF99DEF836146BC9B1B4D22831");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("04188DA80EB03090F67CBF20EB43A18800F4FF0AFD82FF101207192B95FFC8DA78631011ED6B24CDD573F977A11E794811");return new o(v,s,w,t)},secp224r1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF000000000000000000000001");var r=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFFFFFFFFFFFFFFFFFFFE");var q=k("B4050A850C04B3ABF54132565044B0B7D7BFD8BA270B39432355FFB4");var w=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFF16A2E0B8F03E13DD29455C5C2A3D");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("04B70E0CBD6BB4BF7F321390B94A03C1D356C21122343280D6115C1D21BD376388B5F723FB4C22DFE6CD4375A05A07476444D5819985007E34");return new o(v,s,w,t)},secp256k1:function(){var u=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEFFFFFC2F");var r=g.ZERO;var q=k("7");var w=k("FFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFEBAAEDCE6AF48A03BBFD25E8CD0364141");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("0479BE667EF9DCBBAC55A06295CE870B07029BFCDB2DCE28D959F2815B16F81798483ADA7726A3C4655DA4FBFC0E1108A8FD17B448A68554199C47D08FFB10D4B8");return new o(v,s,w,t)},secp256r1:function(){var u=k("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFF");var r=k("FFFFFFFF00000001000000000000000000000000FFFFFFFFFFFFFFFFFFFFFFFC");var q=k("5AC635D8AA3A93E7B3EBBD55769886BC651D06B0CC53B0F63BCE3C3E27D2604B");var w=k("FFFFFFFF00000000FFFFFFFFFFFFFFFFBCE6FAADA7179E84F3B9CAC2FC632551");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("046B17D1F2E12C4247F8BCE6E563A440F277037D812DEB33A0F4A13945D898C2964FE342E2FE1A7F9B8EE7EB4A7C0F9E162BCE33576B315ECECBB6406837BF51F5");return new o(v,s,w,t)},secp384r1:function(){var u=k("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFF");var r=k("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFe FFFFFFFF 00000000 00000000 FFFFFFFC");var q=k("B3312FA7 E23EE7E4 988E056B E3F82D19 181D9C6E FE814112 0314088F 5013875A C656398D 8A2ED19D 2A85C8ED D3EC2AEF");var w=k("FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF C7634D81 F4372DDF 581A0DB2 48B0A77A ECEC196A CCC52973");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("04AA87CA22 BE8B0537 8EB1C71E F320AD74 6E1D3B62 8BA79B98 59F741E0 82542A38 5502F25D BF55296C 3A545E38 72760AB73617DE4A 96262C6F 5D9E98BF 9292DC29 F8F41DBD 289A147C E9DA3113 B5F0B8C0 0A60B1CE 1D7E819D 7A431D7C 90EA0E5F");return new o(v,s,w,t)},secp521r1:function(){var u=k("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF");var r=k("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFF FFFFFFFC");var q=k("    0051 953EB961 8E1C9A1F 929A21A0 B68540EE A2DA725B 99B315F3B8B48991 8EF109E1 56193951 EC7E937B 1652C0BD 3BB1BF07 3573DF883D2C34F1 EF451FD4 6B503F00");var w=k("    01FF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFF FFFFFFFFFFFFFFFF FFFFFFFA 51868783 BF2F966B 7FCC0148 F709A5D0 3BB5C9B8899C47AE BB6FB71E 91386409");var t=g.ONE;var v=new e(u,r,q);var s=v.decodePointHex("      04 00C6858E 06B70404 E9CD9E3E CB662395 B4429C64 8139053FB521F828 AF606B4D 3DBAA14B 5E77EFE7 5928FE1D C127A2FF A8DE3348B3C1856A 429BF97E 7E31C2E5 BD660118 39296A78 9A3BC004 5C8A5FB42C7D1BD9 98F54449 579B4468 17AFBD17 273E662C 97EE7299 5EF42640C550B901 3FAD0761 353C7086 A272C240 88BE9476 9FD16650");return new o(v,s,w,t)}};m.set("cipher.asymmetric.ec.ecparams",function f(p){if(!g){g=m.get("cipher.asymmetric.ec.bigi"),e=m.get("cipher.asymmetric.ec.ecurve")}return(typeof i[p]=="function")?i[p]():null})})(a);"use strict";(function(e){var k;function i(n,l){var m=n.toByteArrayUnsigned();if(l<m.length){m=m.slice(m.length-l)}else{while(l>m.length){m.unshift(0)}}return m}var h=function h(m,l){this.x=l;this.q=m};h.prototype.equals=function(l){if(l==this){return true}return(this.q.equals(l.q)&&this.x.equals(l.x))};h.prototype.toBigInteger=function(){return this.x};h.prototype.negate=function(){return new h(this.q,this.x.negate().mod(this.q))};h.prototype.add=function(l){return new h(this.q,this.x.add(l.toBigInteger()).mod(this.q))};h.prototype.subtract=function(l){return new h(this.q,this.x.subtract(l.toBigInteger()).mod(this.q))};h.prototype.multiply=function(l){return new h(this.q,this.x.multiply(l.toBigInteger()).mod(this.q))};h.prototype.square=function(){return new h(this.q,this.x.square().mod(this.q))};h.prototype.divide=function f(l){return new h(this.q,this.x.multiply(l.toBigInteger().modInverse(this.q)).mod(this.q))};h.prototype.getByteLength=function(){return Math.floor((this.toBigInteger().bitLength()+7)/8)};var g=function g(n,l,o,m){if(!k){k=e.get("cipher.asymmetric.ec.bigi")}this.curve=n;this.x=l;this.y=o;if(m==null){this.z=k.ONE}else{this.z=m}this.zinv=null};g.prototype.getX=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.x.toBigInteger().multiply(this.zinv).mod(this.curve.q))};g.prototype.getY=function(){if(this.zinv==null){this.zinv=this.z.modInverse(this.curve.q)}return this.curve.fromBigInteger(this.y.toBigInteger().multiply(this.zinv).mod(this.curve.q))};g.prototype.equals=function(l){if(l==this){return true}if(this.isInfinity()){return l.isInfinity()}if(l.isInfinity()){return this.isInfinity()}var n,m;n=l.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(l.z)).mod(this.curve.q);if(!n.equals(k.ZERO)){return false}m=l.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(l.z)).mod(this.curve.q);return m.equals(k.ZERO)};g.prototype.isInfinity=function(){if((this.x==null)&&(this.y==null)){return true}return this.z.equals(k.ZERO)&&!this.y.toBigInteger().equals(k.ZERO)};g.prototype.negate=function(){return new g(this.curve,this.x,this.y.negate(),this.z)};g.prototype.add=function(x){if(this.isInfinity()){return x}if(x.isInfinity()){return this}var B=x.y.toBigInteger().multiply(this.z).subtract(this.y.toBigInteger().multiply(x.z)).mod(this.curve.q);var A=x.x.toBigInteger().multiply(this.z).subtract(this.x.toBigInteger().multiply(x.z)).mod(this.curve.q);if(k.ZERO.equals(A)){if(k.ZERO.equals(B)){return this.twice()}return this.curve.getInfinity()}var t=new k("3");var o=this.x.toBigInteger();var z=this.y.toBigInteger();var m=x.x.toBigInteger();var w=x.y.toBigInteger();var y=A.square();var s=y.multiply(A);var n=o.multiply(y);var q=B.square().multiply(this.z);var l=q.subtract(n.shiftLeft(1)).multiply(x.z).subtract(s).multiply(A).mod(this.curve.q);var r=n.multiply(t).multiply(B).subtract(z.multiply(s)).subtract(q.multiply(B)).multiply(x.z).add(B.multiply(s)).mod(this.curve.q);var p=s.multiply(this.z).multiply(x.z).mod(this.curve.q);return new g(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(r),p)};g.prototype.twice=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var q=new k("3");var m=this.x.toBigInteger();var r=this.y.toBigInteger();var o=r.multiply(this.z);var t=o.multiply(r).mod(this.curve.q);var s=this.curve.a.toBigInteger();var u=m.square().multiply(q);if(!k.ZERO.equals(s)){u=u.add(this.z.square().multiply(s))}u=u.mod(this.curve.q);var l=u.square().subtract(m.shiftLeft(3).multiply(t)).shiftLeft(1).multiply(o).mod(this.curve.q);var p=u.multiply(q).multiply(m).subtract(t.shiftLeft(1)).shiftLeft(2).multiply(t).subtract(u.square().multiply(u)).mod(this.curve.q);var n=o.square().multiply(o).shiftLeft(3).mod(this.curve.q);return new g(this.curve,this.curve.fromBigInteger(l),this.curve.fromBigInteger(p),n)};g.prototype.multiply=function(m){if(this.isInfinity()){return this}if(m.signum()==0){return this.curve.getInfinity()}var q=m;var p=q.multiply(new k("3"));var s=this.negate();var o=this;var n;for(n=p.bitLength()-2;n>0;--n){o=o.twice();var l=p.testBit(n);var r=q.testBit(n);if(l!=r){o=o.add(l?this:s)}}return o};g.prototype.multiplyTwo=function(n,l,m){var o;if(n.bitLength()>m.bitLength()){o=n.bitLength()-1}else{o=m.bitLength()-1}var q=this.curve.getInfinity();var p=this.add(l);while(o>=0){q=q.twice();if(n.testBit(o)){if(m.testBit(o)){q=q.add(p)}else{q=q.add(this)}}else{if(m.testBit(o)){q=q.add(l)}}--o}return q};g.prototype.getEncoded=function(o){if(this.isInfinity()){return[0]}var l=this.getX().toBigInteger();var p=this.getY().toBigInteger();var n=Math.floor((this.curve.getQ().bitLength()+7)/8);var m=i(l,n);if(o){if(p.isEven()){m.unshift(2)}else{m.unshift(3)}}else{m.unshift(4);m=m.concat(i(p,n))}return m};g.decodeFrom=function(r,n){var q=n[0];var p=n.length-1;var o=n.slice(1,1+p/2);var m=n.slice(1+p/2,1+p);o.unshift(0);m.unshift(0);var l=new k(o);var s=new k(m);return new g(r,r.fromBigInteger(l),r.fromBigInteger(s))};g.prototype.add2D=function(m){if(this.isInfinity()){return m}if(m.isInfinity()){return this}if(this.x.equals(m.x)){if(this.y.equals(m.y)){return this.twice()}return this.curve.getInfinity()}var q=m.x.subtract(this.x);var o=m.y.subtract(this.y);var l=o.divide(q);var n=l.square().subtract(this.x).subtract(m.x);var p=l.multiply(this.x.subtract(n)).subtract(this.y);return new g(this.curve,n,p)};g.prototype.twice2D=function(){if(this.isInfinity()){return this}if(this.y.toBigInteger().signum()==0){return this.curve.getInfinity()}var m=this.curve.fromBigInteger(k.valueOf(2));var p=this.curve.fromBigInteger(k.valueOf(3));var l=this.x.square().multiply(p).add(this.curve.a).divide(this.y.multiply(m));var n=l.square().subtract(this.x.multiply(m));var o=l.multiply(this.x.subtract(n)).subtract(this.y);return new g(this.curve,n,o)};g.prototype.multiply2D=function(m){if(this.isInfinity()){return this}if(m.signum()==0){return this.curve.getInfinity()}var q=m;var p=q.multiply(new k("3"));var s=this.negate();var o=this;var n;for(n=p.bitLength()-2;n>0;--n){o=o.twice();var l=p.testBit(n);var r=q.testBit(n);if(l!=r){o=o.add2D(l?this:s)}}return o};g.prototype.isOnCurve=function(){if(this.isInfinity()){return true}var m=this.getX().toBigInteger();var s=this.getY().toBigInteger();var p=this.curve.getA().toBigInteger();var l=this.curve.getB().toBigInteger();var r=this.curve.getQ();var o=s.multiply(s).mod(r);var q=m.multiply(m).multiply(m).add(p.multiply(m)).add(l).mod(r);return o.equals(q)};g.prototype.toString=function(){if(this.isInfinity()){return"(INFINITY)"}return"("+this.getX().toBigInteger().toString()+","+this.getY().toBigInteger().toString()+")"};g.prototype.validate=function(){var o=this.curve.getQ();if(this.isInfinity()){throw new Error("Point is at infinity.")}var l=this.getX().toBigInteger();var m=this.getY().toBigInteger();if(l.compareTo(k.ONE)<0||l.compareTo(o.subtract(k.ONE))>0){throw new Error("x coordinate out of bounds")}if(m.compareTo(k.ONE)<0||m.compareTo(o.subtract(k.ONE))>0){throw new Error("y coordinate out of bounds")}if(!this.isOnCurve()){throw new Error("Point is not on the curve.")}if(this.multiply(o).isInfinity()){throw new Error("Point is not a scalar multiple of G.")}return true};var j=function j(n,m,l){this.q=n;this.a=this.fromBigInteger(m);this.b=this.fromBigInteger(l);this.infinity=new g(this,null,null)};j.prototype.getQ=function(){return this.q};j.prototype.getA=function(){return this.a};j.prototype.getB=function(){return this.b};j.prototype.equals=function(l){if(l==this){return true}return(this.q.equals(l.q)&&this.a.equals(l.a)&&this.b.equals(l.b))};j.prototype.getInfinity=function(){return this.infinity};j.prototype.fromBigInteger=function(l){return new h(this.q,l)};j.prototype.decodePointHex=function(o){o=o.replace(/[^0-9a-f]/ig,"");switch(parseInt(o.substr(0,2),16)){case 0:return this.infinity;case 2:case 3:return null;case 4:case 6:case 7:var l=(o.length-2)/2;var n=o.substr(2,l);var m=o.substr(l+2,l);return new g(this,this.fromBigInteger(new k(n,16)),this.fromBigInteger(new k(m,16)));default:return null}};j.ECPointFp=g;e.set("cipher.asymmetric.ec.ecurve",j)})(a);(function(e){var i={};var f={NECRAC256:{name:"NECRAC256",secretLength:64,sign:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},crypt:{algorithm:"ec",parameters:{curve:"secp521r1"},secretLength:64},hashAlgorithm:"WHIRLPOOL"},NECRAC192:{name:"NECRAC192",secretLength:48,sign:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},crypt:{algorithm:"ec",parameters:{curve:"secp384r1"},secretLength:48},hashAlgorithm:"BLAKE2s"},NECRAC128:{name:"NECRAC128",secretLength:32,sign:{algorithm:"ec",parameters:{curve:"secp256r1"},secretLength:32},crypt:{algorithm:"ec",parameters:{curve:"secp256k1"},secretLength:32},hashAlgorithm:"BLAKE2s"},NECRAC112:{name:"NECRAC112",secretLength:28,sign:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},crypt:{algorithm:"ec",parameters:{curve:"secp224r1"},secretLength:28},hashAlgorithm:"RIPEMD160"},NECRAC96:{name:"NECRAC96",secretLength:24,sign:{algorithm:"ec",parameters:{curve:"secp192k1"},secretLength:24},crypt:{algorithm:"ec",parameters:{curve:"secp192r1"},secretLength:24},hashAlgorithm:"RIPEMD160"}};function j(p){var w=this;var q=f[p];var u,o;if(!q){throw new Error("invalid-algorithm-choice")}function k(y){var x=new e.get("hash")(q.hashAlgorithm);return x.hash(y).buffer}function t(x){var y=e.get("cipher.asymmetric."+x.algorithm).constructor;return y(x.parameters)}u=t(q.sign);o=t(q.crypt);function v(x){if(x){w.sign=m;w.decrypt=l}w.verify=s;w.encrypt=r;w.getPublicKey=n;delete w.setPrivateKey;delete w.setPublicKey}function n(){var y=u.getPublicKey(),x=o.getPublicKey();return e.get("util.buffer").concat([new Uint16Array([y.byteLength]).buffer,y,x])}function m(y){if(!e.get("util.type")(y).isArrayBuffer()){throw new Error("invalid-parameter")}var x=k(y);return u.sign(x)}function s(z,x){if(!(e.get("util.type")(z).isArrayBuffer()&&e.get("util.type")(x).isArrayBuffer())){throw new Error("invalid-parameter")}var y=k(z);return u.verify(y,x)}function r(x){if(!e.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-parameter")}return o.encrypt(x)}function l(x){if(!e.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-parameter")}return o.decrypt(x)}this.setPrivateKey=function(x){if(!e.get("util.type")(x).isArrayBuffer()){throw new Error("invalid-parameter")}var B=new e.get("hash")(q.hashAlgorithm).pbkdf2;var A=B(x,e.get("util.encoding")("derivation-of-signing-key","ascii").toArrayBuffer(),4,q.sign.secretLength);var y=B(x,e.get("util.encoding")("derivation-of-encrypting-key","ascii").toArrayBuffer(),4,q.crypt.secretLength);try{u.setPrivateKey(A);o.setPrivateKey(y)}catch(z){throw new Error("invalid-private-key")}v(true)};this.setPublicKey=function(y){if(!(e.get("util.type")(y).isArrayBuffer()&&y.byteLength>2)){throw new Error("invalid-public-key")}var z=new Uint16Array(y.slice(0,2))[0];y=y.slice(2);if(y.byteLength<=z){throw new Error("invalid-public-key")}var B=y.slice(0,z),x=y.slice(z);try{u.setPublicKey(B);o.setPublicKey(x)}catch(A){throw new Error("invalid-public-key")}v(false)};return this}function g(k){if(k){e.get("util.log").notice("Load asymmetric cipher component: ["+k.name+"]");i[k.name]=k.constructor;return}if("undefined"!=typeof i.EC){e.get("util.log").notice("Asymmetric ciphers ready.");return function(l){return new j(l)}}return null}var h=function(k){return new j(k)};e.set("cipher.asymmetric",h);e.set("cipher.asymmetric.definition",function(k){return f[k]||null});e.exp("cipher.asymmetric",h)})(a);(function(e){function f(){var A=16;var B=4;var o=4;var k=[99,124,119,123,242,107,111,197,48,1,103,43,254,215,171,118,202,130,201,125,250,89,71,240,173,212,162,175,156,164,114,192,183,253,147,38,54,63,247,204,52,165,229,241,113,216,49,21,4,199,35,195,24,150,5,154,7,18,128,226,235,39,178,117,9,131,44,26,27,110,90,160,82,59,214,179,41,227,47,132,83,209,0,237,32,252,177,91,106,203,190,57,74,76,88,207,208,239,170,251,67,77,51,133,69,249,2,127,80,60,159,168,81,163,64,143,146,157,56,245,188,182,218,33,16,255,243,210,205,12,19,236,95,151,68,23,196,167,126,61,100,93,25,115,96,129,79,220,34,42,144,136,70,238,184,20,222,94,11,219,224,50,58,10,73,6,36,92,194,211,172,98,145,149,228,121,231,200,55,109,141,213,78,169,108,86,244,234,101,122,174,8,186,120,37,46,28,166,180,198,232,221,116,31,75,189,139,138,112,62,181,102,72,3,246,14,97,53,87,185,134,193,29,158,225,248,152,17,105,217,142,148,155,30,135,233,206,85,40,223,140,161,137,13,191,230,66,104,65,153,45,15,176,84,187,22];var n=[82,9,106,213,48,54,165,56,191,64,163,158,129,243,215,251,124,227,57,130,155,47,255,135,52,142,67,68,196,222,233,203,84,123,148,50,166,194,35,61,238,76,149,11,66,250,195,78,8,46,161,102,40,217,36,178,118,91,162,73,109,139,209,37,114,248,246,100,134,104,152,22,212,164,92,204,93,101,182,146,108,112,72,80,253,237,185,218,94,21,70,87,167,141,157,132,144,216,171,0,140,188,211,10,247,228,88,5,184,179,69,6,208,44,30,143,202,63,15,2,193,175,189,3,1,19,138,107,58,145,17,65,79,103,220,234,151,242,207,206,240,180,230,115,150,172,116,34,231,173,53,133,226,249,55,232,28,117,223,110,71,241,26,113,29,41,197,137,111,183,98,14,170,24,190,27,252,86,62,75,198,210,121,32,154,219,192,254,120,205,90,244,31,221,168,51,136,7,199,49,177,18,16,89,39,128,236,95,96,81,127,169,25,181,74,13,45,229,122,159,147,201,156,239,160,224,59,77,174,42,245,176,200,235,187,60,131,83,153,97,23,43,4,126,186,119,214,38,225,105,20,99,85,33,12,125];var z=[0,16777216,33554432,67108864,134217728,268435456,536870912,1073741824,2147483648,452984832,905969664];function C(E,D){var G=0;var F;while(E){if((E&1)){G=G^D}F=D&128;D<<=1;if(F){D^=27}E>>=1}return G}function l(F){var E=new Array(256);for(var D=0;D<256;D++){E[D]=C(F,D)&255}return E}var x=l(2);var v=l(3);var p=l(9);var w=l(11);var u=l(13);var t=l(14);function y(D){var E=k;return(E[D>>>24]<<24|E[(D>>>16)&255]<<16|E[(D>>>8)&255]<<8|E[D&255])}function r(D){return D>>>24|D<<8}function m(D){return D>>>24|(D&16711680)>>>8|(D&65280)<<8|(D&255)<<24}var q=((new Uint8Array((new Uint32Array([1])).buffer))[0]==1);function s(J){var D=z;var F=new Uint8Array(J);var H=F.length/4;var K=H+6;var E=new Uint32Array(o*(K+1));for(var I=0;I<H;I++){E[I]=(F[I*4]<<24|F[I*4+1]<<16|F[I*4+2]<<8|F[I*4+3])}for(var I=H;I<o*(K+1);I++){var G=E[I-1];if(I%H==0){G=y(r(G))^D[I/H]}else{if(H>6&&I%H==4){G=y(G)}}E[I]=E[I-H]^G}if(q){for(var I=0;I<E.length;I++){E[I]=m(E[I])}}return E}function i(D,M){var J=(M.length/o-1)*4;var Q,O,L,K;var H,G,F,E;var T,S,P,N;var I=k;Q=(D[0]^M[0])>>>0;O=(D[1]^M[1])>>>0;L=(D[2]^M[2])>>>0;K=(D[3]^M[3])>>>0;for(var R=4;R<J;R+=4){H=Q;G=O;F=L;E=K;T=I[H&255]>>>0;S=I[(G>>>8)&255]>>>0;P=I[(F>>>16)&255]>>>0;N=I[E>>>24]>>>0;Q=(((x[T]^v[S]^P^N)|(T^x[S]^v[P]^N)<<8|(T^S^x[P]^v[N])<<16|(v[T]^S^P^x[N])<<24)^M[R])>>>0;T=I[G&255]>>>0;S=I[(F>>>8)&255]>>>0;P=I[(E>>>16)&255]>>>0;N=I[H>>>24]>>>0;O=(((x[T]^v[S]^P^N)|(T^x[S]^v[P]^N)<<8|(T^S^x[P]^v[N])<<16|(v[T]^S^P^x[N])<<24)^M[R+1])>>>0;T=I[F&255]>>>0;S=I[(E>>>8)&255]>>>0;P=I[(H>>>16)&255]>>>0;N=I[G>>>24]>>>0;L=(((x[T]^v[S]^P^N)|(T^x[S]^v[P]^N)<<8|(T^S^x[P]^v[N])<<16|(v[T]^S^P^x[N])<<24)^M[R+2])>>>0;T=I[E&255]>>>0;S=I[(H>>>8)&255]>>>0;P=I[(G>>>16)&255]>>>0;N=I[F>>>24]>>>0;K=(((x[T]^v[S]^P^N)|(T^x[S]^v[P]^N)<<8|(T^S^x[P]^v[N])<<16|(v[T]^S^P^x[N])<<24)^M[R+3])>>>0}D[0]=M[J]^(I[Q&255]|I[(O>>>8)&255]<<8|I[(L>>>16)&255]<<16|I[K>>>24]<<24);D[1]=M[J+1]^(I[O&255]|I[(L>>>8)&255]<<8|I[(K>>>16)&255]<<16|I[Q>>>24]<<24);D[2]=M[J+2]^(I[L&255]|I[(K>>>8)&255]<<8|I[(Q>>>16)&255]<<16|I[O>>>24]<<24);D[3]=M[J+3]^(I[K&255]|I[(Q>>>8)&255]<<8|I[(O>>>16)&255]<<16|I[L>>>24]<<24)}function j(D,M){var E=n;var J=(M.length/o-1)*4;var O,N,L,K;var I,H,G,F;O=(D[0]^M[J])>>>0;N=(D[1]^M[J+1])>>>0;L=(D[2]^M[J+2])>>>0;K=(D[3]^M[J+3])>>>0;for(var P=J-4;P>0;P-=4){I=O;H=N;G=L;F=K;O=((E[I&255]|E[(F>>>8)&255]<<8|E[(G>>>16)&255]<<16|E[H>>>24]<<24)^M[P])>>>0;N=((E[H&255]|E[(I>>>8)&255]<<8|E[(F>>>16)&255]<<16|E[G>>>24]<<24)^M[P+1])>>>0;L=((E[G&255]|E[(H>>>8)&255]<<8|E[(I>>>16)&255]<<16|E[F>>>24]<<24)^M[P+2])>>>0;K=((E[F&255]|E[(G>>>8)&255]<<8|E[(H>>>16)&255]<<16|E[I>>>24]<<24)^M[P+3])>>>0;I=O&255>>>0;H=((O>>>8)&255)>>>0;G=((O>>>16)&255)>>>0;F=O>>>24;O=((t[I]^w[H]^u[G]^p[F])|(p[I]^t[H]^w[G]^u[F])<<8|(u[I]^p[H]^t[G]^w[F])<<16|(w[I]^u[H]^p[G]^t[F])<<24)>>>0;I=(N&255)>>>0;H=((N>>>8)&255)>>>0;G=((N>>>16)&255)>>>0;F=N>>>24;N=((t[I]^w[H]^u[G]^p[F])|(p[I]^t[H]^w[G]^u[F])<<8|(u[I]^p[H]^t[G]^w[F])<<16|(w[I]^u[H]^p[G]^t[F])<<24)>>>0;I=(L&255)>>>0;H=((L>>>8)&255)>>>0;G=((L>>>16)&255)>>>0;F=L>>>24;L=((t[I]^w[H]^u[G]^p[F])|(p[I]^t[H]^w[G]^u[F])<<8|(u[I]^p[H]^t[G]^w[F])<<16|(w[I]^u[H]^p[G]^t[F])<<24)>>>0;I=(K&255)>>>0;H=((K>>>8)&255)>>>0;G=((K>>>16)&255)>>>0;F=K>>>24;K=((t[I]^w[H]^u[G]^p[F])|(p[I]^t[H]^w[G]^u[F])<<8|(u[I]^p[H]^t[G]^w[F])<<16|(w[I]^u[H]^p[G]^t[F])<<24)>>>0}D[0]=M[0]^(E[O&255]|E[(K>>>8)&255]<<8|E[(L>>>16)&255]<<16|E[N>>>24]<<24);D[1]=M[1]^(E[N&255]|E[(O>>>8)&255]<<8|E[(K>>>16)&255]<<16|E[L>>>24]<<24);D[2]=M[2]^(E[L&255]|E[(N>>>8)&255]<<8|E[(O>>>16)&255]<<16|E[K>>>24]<<24);D[3]=M[3]^(E[K&255]|E[(L>>>8)&255]<<8|E[(N>>>16)&255]<<16|E[O>>>24]<<24)}return{block_size_bytes:A,block_size_words:B,endian_swap32:m,is_little_endian:q,key_expansion:s,cipher:i,inv_cipher:j}}function h(){var i=this;var k=new f(),l;function j(o){if(!(e.get("util.type")(o).isArrayBuffer()&&0==o.byteLength%k.block_size_bytes)){throw new Error("invalid-input")}var s=new Uint32Array(o);var t=new Uint32Array(s.length);var q=new Uint32Array(k.block_size_words);var n=k.key_expansion(l);var r,p;for(r=0;r<s.length;r+=k.block_size_words){for(p=0;p<k.block_size_words;p++){q[p]=s[r+p]}k.cipher(q,n);t.set(q,r)}return t.buffer}function m(o){if(!(e.get("util.type")(o).isArrayBuffer()&&0==o.byteLength%k.block_size_bytes)){throw new Error("invalid-input")}var s=new Uint32Array(o);var t=new Uint32Array(s.length);var q=new Uint32Array(k.block_size_words);var u=new Uint32Array(k.block_size_words);var n=k.key_expansion(l),r,p;for(r=0;r<s.length;r+=k.block_size_words){for(p=0;p<k.block_size_words;p++){u[p]=s[r+p]}q.set(u);k.inv_cipher(q,n);t.set(q,r)}return t.buffer}this.key=function(o){if(!e.get("util.type")(o).isArrayBuffer()){throw new Error("invalid-key")}var n=o.byteLength;if(n>32){o=o.slice(0,32)}else{if(n>24){o=o.slice(0,24)}else{if(n>16){o=o.slice(0,16)}else{throw new Error("invalid-key-length")}}}l=new Uint32Array(o);i.encrypt=j;i.decrypt=m;delete i.key;return i};return this}var g={name:"AESECB",constructor:function(){return new h()}};e.set("cipher.symmetric.aes",g)})(a);(function(f){function e(s){var t=this;if(!s||s<10){s=10}var r=new Uint32Array(16);function k(A,w){function z(B,x){return(((B)<<(x))|((B)>>>(32-(x))))}var y;var v=r;for(y=0;y<16;y++){v[y]=A[y]}for(y=0;y<s;y++){v[4]^=z(v[0]+v[12],7);v[8]^=z(v[4]+v[0],9);v[12]^=z(v[8]+v[4],13);v[0]^=z(v[12]+v[8],18);v[9]^=z(v[5]+v[1],7);v[13]^=z(v[9]+v[5],9);v[1]^=z(v[13]+v[9],13);v[5]^=z(v[1]+v[13],18);v[14]^=z(v[10]+v[6],7);v[2]^=z(v[14]+v[10],9);v[6]^=z(v[2]+v[14],13);v[10]^=z(v[6]+v[2],18);v[3]^=z(v[15]+v[11],7);v[7]^=z(v[3]+v[15],9);v[11]^=z(v[7]+v[3],13);v[15]^=z(v[11]+v[7],18);v[1]^=z(v[0]+v[3],7);v[2]^=z(v[1]+v[0],9);v[3]^=z(v[2]+v[1],13);v[0]^=z(v[3]+v[2],18);v[6]^=z(v[5]+v[4],7);v[7]^=z(v[6]+v[5],9);v[4]^=z(v[7]+v[6],13);v[5]^=z(v[4]+v[7],18);v[11]^=z(v[10]+v[9],7);v[8]^=z(v[11]+v[10],9);v[9]^=z(v[8]+v[11],13);v[10]^=z(v[9]+v[8],18);v[12]^=z(v[15]+v[14],7);v[13]^=z(v[12]+v[15],9);v[14]^=z(v[13]+v[12],13);v[15]^=z(v[14]+v[13],18)}for(y=0;y<16;y++){w[y]=v[y]+A[y]}}var n=new Uint32Array(16);function j(w,y){var v=n,x=new Uint32Array([1634760805,857760878,2036477234,1797285236]);v[0]=x[0];v[1]=y[0];v[2]=y[1];v[3]=y[2];v[4]=y[3];v[5]=x[1];v[6]=w[0];v[7]=w[1];v[10]=x[2];v[11]=y[4];v[12]=y[5];v[13]=y[6];v[14]=y[7];v[15]=x[3]}function l(x,w){var v=n;v[8]=x[0];v[9]=x[1];return k(v,w)}function j(x,w){var v=n;tau=new Uint32Array([1634760805,824206446,2036477238,1797285236]);v[0]=tau[0];v[1]=w[0];v[2]=w[1];v[3]=w[2];v[4]=w[3];v[5]=tau[1];v[6]=x[0];v[7]=x[1];v[10]=tau[2];v[11]=w[0];v[12]=w[1];v[13]=w[2];v[14]=w[3];v[15]=tau[3]}function p(x,w){var v=n;v[8]=x[0];v[9]=x[1];return k(v,w)}var h=new Uint32Array(2);var o;function q(){h[0]=0;h[1]=0}function u(){h[0]+=1;if(0==h[0]){h[1]+=1}}function m(v,y){var x=new Uint32Array(v);if(32==y.byteLength){var w=new Uint32Array(y);j(x,w);o=(function(){return function(z){l(h,z);u()}})()}else{if(16==y.byteLength){var w=new Uint32Array(y);_salsa20BufferFillKey4(x,w);o=(function(){return function(z){p(h,z);u()}})()}else{throw new Error("invalid-key-length")}}}function i(B){if(!f.get("util.type")(B).isArrayBuffer()){throw new Error("invalid-input")}var v=B.byteLength,z=Math.ceil(v/64),w=new Uint32Array(16);var C=new Uint8Array(B),D=new Uint8Array(C.length+64);var A=0,y,x;q();for(y=0;y<z;y++){o(w);for(x=0;x<16;x++){D[A++]=(w[x]>>24)&255;D[A++]=(w[x]>>16)&255;D[A++]=(w[x]>>8)&255;D[A++]=w[x]&255}}for(y=0;y<v;y++){C[y]^=D[y]}return C.buffer}this.key=function(w){if(!f.get("util.type")(w).isArrayBuffer()){throw new Error("invalid-key")}var x=w.byteLength;if(x<24){throw new Error("invalid-key")}var v=w.slice(0,8);if(x<40){m(v,w.slice(8,24))}else{m(v,w.slice(8,40))}t.encrypt=i;t.decrypt=i;delete t.key;return t};return this}var g={name:"Salsa20/20",constructor:function(){return new e(20)}};f.set("cipher.symmetric.salsa20",g)})(a);(function(g){function f(){var t=this;function s(w,y){var A=w.byteLength,z=y-(A%y),B=A+z,v=new Uint8Array(w),u=new Uint8Array(B);for(var x=0;x<B;x++){if(x<A){u[x]=v[x]}else{u[x]=z}}return u.buffer}function r(v){var u=new Uint8Array(v);var w=u[u.length-1];if(u.length<w){return null}return v.slice(0,v.byteLength-w)}function o(u){return u}function l(u){return u}var n=null;function p(x,v,y){var A=64;var z=new g.get("hash")("BLAKE2s").pbkdf2(x,v,4,y*A);var u=new Array(y);for(var w=0;w<y;w++){u[w]=new g.get("hash")("WHIRLPOOL").hash(z.slice(w*A,(w+1)*A)).buffer}return u}var q=function(w){if(!g.get("util.type")(w).isArrayBuffer()){throw new Error("invalid-parameter")}var v=new g.get("util.srand")().bytes(10);var x=p(n,v,5);var y=new g.get("hash")("BLAKE2s",{length:6}).mac(w,x[0]).buffer;w=g.get("util.buffer").concat([y,w]);var u=w;u=o(u);u=s(u,16);u=e(x[1],u);u=k(x[2],u);return g.get("util.buffer").concat([v,u])};var m=function(w){if(!(g.get("util.type")(w).isArrayBuffer()&&w.byteLength>=26)){throw new Error("invalid-parameter")}var y=w.slice(0,10);w=w.slice(10);var z=p(n,y,5);var v=w;v=i(z[2],v);v=h(z[1],v);v=r(v,16);if(!g.get("util.type")(v).isArrayBuffer()){return null}v=l(v);if(!g.get("util.type")(v).isArrayBuffer()){return null}var x=v.slice(0,6);v=v.slice(6);var u=new g.get("hash")("BLAKE2s",{length:6}).mac(v,z[0]).buffer;if(g.get("util.buffer").equal(x,u)){return v}return null};this.key=function(u){if(!g.get("util.type")(u).isArrayBuffer()){throw new Error("invalid-key")}n=u;delete t.key;t.encrypt=q;t.decrypt=m;return t};return this}var k=function(l,n){try{var m=g.get("cipher.symmetric.aes").constructor;return m().key(l).encrypt(n)}catch(o){g.get("util.log").error(o);return new Error("unable-to-encrypt",o)}};var i=function(l,n){try{var m=g.get("cipher.symmetric.aes").constructor;return m().key(l).decrypt(n)}catch(o){g.get("util.log").error(o);return new Error("unable-to-decrypt",o)}};var e=function(l,m){try{var o=g.get("cipher.symmetric.salsa20").constructor;return o().key(l).encrypt(m)}catch(n){g.get("util.log").error(n);return new Error("unable-to-encrypt")}};var h=function(l,m){try{var o=g.get("cipher.symmetric.salsa20").constructor;return o().key(l).decrypt(m)}catch(n){g.get("util.log").error(n);return new Error("unable-to-decrypt",n)}};function j(){return new f()}g.set("cipher.symmetric",j);g.exp("cipher.symmetric",j)})(a);(function(e){function f(){var g=this;return this}})(a);(function(g){var f={defaultAlgorithmName:"NECRAC128",subjectRule:/^[0-9a-z\s]{8,255}$/i};var h={_:["constant",new Uint8Array([69,73]).buffer],subject:"shortBinary",algorithm:["enum","NECRAC96","NECRAC112","NECRAC128","NECRAC192","NECRAC256"],"public":"binary",secret:"shortBinary",signature:"binary"};function e(){var y=this;var n=g.get("hash");var A=g.get("util.buffer");var j=g.get("cipher.asymmetric.definition");var w=g.get("util.type");var D=g.get("util.serialize")(h);var C,o,r,u,t,F;var x=false;function p(){if(x){return x}x=n("WHIRLPOOL").mac(r,C).buffer;return x}function m(I){y.exportPublic=B;y.verify=k;y.encrypt=z;y.getFingerprint=q;y.getHash=p;y.getSubject=v;y.getAlgorithm=H;if(I){y.decrypt=l;y.sign=G;y.exportPrivate=s}y.isPrivate=function(){return Boolean(I)};delete y.generate;delete y.loadPublic;delete y.loadPrivate}this.generate=function(K,J){if(!J){J={}}if(!f.subjectRule.test(K)){throw new Error("enigma-invalid-input")}C=g.get("util.encoding")(K,"ascii").toArrayBuffer();u=J.algorithm||f.defaultAlgorithmName;var I=j(u);if(!I){u=defaults.algorithmName;I=j(algorithmname)}o=g.get("util.srand")().bytes(I.secretLength);F=g.get("cipher.asymmetric")(I.name);F.setPrivateKey(o);r=F.getPublicKey();t=F.sign(p());m(true)};function E(I,S){if(!w(I).isArrayBuffer()){throw new Error("enigma-invalid-input")}if(S&&!w(S).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{var O=D.deserialize(I)}catch(N){throw new Error("enigma-invalid-input")}var P=O.subject,L=O.algorithm,M=O.signature,J=O["public"],R=O.secret;if(!f.subjectRule.test(g.get("util.encoding")(P).toASCII())){throw new Error("enigma-invalid-input")}C=P;u=L;t=M;r=J;F=g.get("cipher.asymmetric")(u);if(S){try{o=g.get("cipher.symmetric")().key(S).decrypt(R)}catch(N){throw new Error("enigma-invalid-pinkey")}F.setPrivateKey(o);var K=F.getPublicKey();if(!g.get("util.buffer").equal(K,r)){throw new Error("enigma-identity-invalid")}}else{F.setPublicKey(r)}try{var Q=F.verify(p(),t);if(!Q){throw new Error("enigma-identity-invalid")}}catch(N){console.error("Public key self signature check failed.");throw new Error("enigma-identity-invalid")}return true}this.loadPublic=function(I){if(E(I)){m(false)}};this.loadPrivate=function(J,I){if(E(J,I)){m(true)}};this.canLoadPrivate=function(I){if(!w(I).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{var K=D.deserialize(I)}catch(J){throw new Error("enigma-invalid-input")}return Boolean(null!=K.secret)};function v(){return g.get("util.encoding")(C).toASCII()}function H(){return u}function q(J){var I=p().slice(0,10);if(J){return g.get("util.encoding")(I).toBase32()}return I}function B(){var I=D.serialize({subject:C,algorithm:u,"public":r,secret:new Uint8Array(0).buffer,signature:t});return I}function s(I){if(!(w(I).isArrayBuffer()&&I.byteLength>=32)){throw new Error("enigma-invalid-pinkey")}var K=g.get("cipher.symmetric")().key(I).encrypt(o);var J=D.serialize({subject:C,algorithm:u,"public":r,secret:K,signature:t});return J}function k(J,I){if(!(w(J).isArrayBuffer()&&w(I).isArrayBuffer())){throw new Error("enigma-invalid-input")}try{return true===F.verify(J,I)}catch(K){return false}}function G(I){if(!w(I).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return F.sign(I)}catch(J){throw new Error("enigma-identity-unable-to-sign")}}function z(I){if(!w(I).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return F.encrypt(I)}catch(J){throw new Error("enigma-identity-unable-to-encrypt")}}function l(I){if(!w(I).isArrayBuffer()){throw new Error("enigma-invalid-input")}try{return F.decrypt(I)}catch(J){throw new Error("enigma-identity-unable-to-decrypt")}}return this}var i=function(){return new e()};g.set("enigma.identity",i);g.exp("enigma.identity",i)})(a);(function(g){var e={_:["constant",new Uint8Array([69,112]).buffer],signers:"shortArray",signatures:"array",content:"longBinary"};var f={_:["constant",new Uint8Array([69,67]).buffer],compression:["enum",false,"lzw"],receivers:"shortArray",decryptors:"array",payload:"longBinary"};function h(){var v=this;var t=g.get("util.type");var r=g.get("util.serialize")(e),p=g.get("util.serialize")(f);var q,y,B=[],m=[],z=[],n=[],C=false;var E,F;this.write=function(H,G){if(!t(H).isArrayBuffer()){throw new Error("enigma-invalid-input")}q=H;y=new g.get("util.srand")().bytes(64);C=(G&&true===G.clearsign);delete v.write;delete v.read;v.sign=D;if(!C){v.encrypt=x}};this.read=function(K){if(!t(K).isArrayBuffer()){throw new Error("enigma-invalid-input")}var I=true;try{var H=p.deserialize(K)}catch(L){I=false}if(I){var N=H.receivers,J=H.decryptors,M=H.compression,G=H.payload;E=G;F=M;if(N.length!=J.length){throw new Error("enigma-invalid-input")}if(N.length>0){m=J;B=N;v.decrypt=l;v.getReceivers=j;delete v.write;delete v.read;return}}else{F=false;E=K}o();delete v.write;delete v.read};function o(){if("lzw"==F){try{E=g.get("util.decompress")(E)}catch(K){throw new Error("enigma-invalid-input")}}else{if(false!==F){throw new Error("enigma-invalid-input")}}try{var I=r.deserialize(E)}catch(K){throw new Error("enigma-invalid-input")}var J=I.signatures,H=I.signers,G=I.content;if(J.length!=H.length){throw new Error("enigma-invalid-input")}q=G;v.getPlaintext=u;if(H.length>0){z=J;n=H;v.verify=k;v.getSigners=A}}function D(I){if(!I.isPrivate()){throw new Error("enigma-invalid-identity-for-sign")}var H=I.getFingerprint();var G=I.sign(q);n.push(H);z.push(G);if(n.length>=255){delete v.sign}if(undefined==v.done){v.done=w}}function x(G){var H=G.encrypt(y);var I=G.getFingerprint();B.push(I);m.push(H);if(B.length>=255){delete v.encrypt}if(undefined==v.done){v.done=w}return true}function w(){delete v.sign;delete v.encrypt;var I=r.serialize({signers:n,signatures:z,content:q});if(C){return I}var G="lzw";if(G){I=g.get("util.compress")(I)}var J=(m.length>0);if(J){I=g.get("cipher.symmetric")().key(y).encrypt(I)}var H=p.serialize({compression:G||false,receivers:B,decryptors:m,payload:I});delete v.done;return H}function l(M){if(!M.isPrivate()){throw new Error("enigma-invalid-identity-for-decrypt")}var I=M.getFingerprint(),K=false;for(var H=0;H<B.length;H++){if(g.get("util.buffer").equal(I,B[H])){K=true;break}}if(!K){throw new Error("enigma-invalid-identity-for-decrypt")}var J=m[H];try{var G=M.decrypt(J)}catch(L){throw new Error("enigma-invalid-identity-for-decrypt")}try{E=g.get("cipher.symmetric")().key(G).decrypt(E)}catch(L){throw new Error("enigma-message-corrupted")}o(E);delete v.decrypt;delete v.getReceivers}function k(L){var I=L.getFingerprint(),J=false;for(var H=0;H<n.length;H++){if(g.get("util.buffer").equal(I,n[H])){J=true;break}}if(!J){throw new Error("enigma-invalid-identity-for-verify")}var G=z[H];try{return L.verify(q,G)}catch(K){throw new Error("enigma-invalid-identity-for-verify")}}function u(){return q}function s(G){var H=[];for(var I in G){H.push(g.get("util.encoding")(G[I]).toBase32())}return H}function j(){return s(B)}function A(){return s(n)}return this}function i(){return new h()}g.set("enigma.message",i);g.exp("enigma.message",i)})(a);(function(e){function g(k,i){var j=[];j.push(function l(){return{question:"text.fingerprint"}});j.push(function h(o,p){i("Operation - delete identity, received.");var q=e.get("enigma.interface.storage")(k),n=p["text.fingerprint"];var m=q.value(n);if(null==m){return{terminate:true,error:"identity-not-found"}}q.remove(n);i("Identity ["+n+"] is deleted.");return{terminate:n}});return j}var f={variables:{"text.fingerprint":{type:"string",validate:function(h){return/^[0-9a-z]+$/i.test(h)}}},errors:["identity-not-found"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.identity-delete",f)})(a);(function(e){function g(j,h){var m=[];m.push(function i(){return{data:{},question:"text.fingerprint"}});m.push(function p(t,u){var v=e.get("enigma.interface.storage")(j);var r=u["text.fingerprint"];var s=v.note(r,"isPrivate");if(null===s){return{terminate:true,error:"identity-not-found"}}t.isPrivate=s;if(!s){return{data:t,jump:"doer"}}return{data:t}});m.push(function n(){return{question:"option.include-private"}});m.push(function o(r,s){if(!s["option.include-private"]){return{jump:"doer"}}return{}});m.push(function l(){return{question:"text.passphrase"}});m.push(function k(){return{question:"text.save-passphrase"}});m.push(function q(w,z){h("Operation - export identity, received.");var x=e.get("enigma.interface.storage")(j),v=z["text.fingerprint"];var t=x.value(v);var s=true,D,u;if(false===w.isPrivate){s=false}else{if(!z["option.include-private"]){s=false}else{D=e.get("util.encoding")(z["text.passphrase"],"ascii").toArrayBuffer();u=e.get("util.encoding")(z["text.save-passphrase"],"ascii").toArrayBuffer()}}if(null==t){return{terminate:true,error:"identity-not-found"}}try{var C=e.get("util.encoding")(t,"base64").toArrayBuffer();var A=e.get("enigma.identity")();console.log(t);if(s){h("Private identity is being read.");A.loadPrivate(C,D)}else{h("Public identity is being read.");A.loadPublic(C)}}catch(y){console.log(y);return{error:"identity-could-not-be-loaded",terminate:true}}if(s){var r=A.exportPrivate(u)}else{var r=A.exportPublic()}var B=e.get("util.encoding")(r).toHEX();return{terminate:B}});return m}var f={variables:{"text.fingerprint":{type:"string",validate:function(h){return/^[0-9a-z]+$/i.test(h)}},"text.passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}},"text.save-passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}},"option.include-private":"boolean"},errors:["identity-not-found","identity-could-not-be-loaded"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.identity-export",f)})(a);(function(e){function g(m,j){var l=[];l.push(function k(){return{question:"text.subject"}});l.push(function h(){return{question:"select.algorithm"}});l.push(function i(){return{question:"text.passphrase"}});l.push(function n(r,q){var v=e.get("enigma.interface.storage")(m);var s=e.get("enigma.identity")(),u=e.get("util.encoding")(q["text.passphrase"],"ascii").toArrayBuffer();s.generate(q["text.subject"],{algorithm:q["select.algorithm"]});var p=s.getFingerprint(true),t=s.exportPrivate(u);var o=e.get("util.encoding")(t).toBase64();v.value(p,o);v.note(p,"subject",q["text.subject"]);v.note(p,"isPrivate",true);v.note(p,"algorithm",q["select.algorithm"]);return{terminate:p}});return l}var f={variables:{"text.subject":{type:"string",validate:function(h){return/^[0-9a-z\s]{8,255}$/i.test(h)}},"text.passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}},"select.algorithm":["enum",["NECRAC256","NECRAC192","NECRAC128","NECRAC112","NECRAC96"]]},errors:[],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.identity-generate",f)})(a);(function(e){function g(l,k){var o=[];o.push(function m(){return{question:"text.data"}});o.push(function p(s,r){var t=e.get("util.encoding")(r["text.data"],"hex");s.identityBuf=t.toArrayBuffer();return{data:s}});o.push(function h(u,t){var s=false,r=e.get("enigma.identity")();try{s=r.canLoadPrivate(u.identityBuf)}catch(v){console.error(v);return{error:"identity-could-not-be-loaded",terminate:true}}if(!s){return{data:{isPrivate:false},jump:"loadIdentity"}}return{data:{isPrivate:true}}});o.push(function i(){return{question:"text.read-passphrase"}});o.push(function j(t,s){var v={};v.identity=e.get("enigma.identity")();try{if(t.isPrivate){var r=e.get("util.encoding")(s["text.read-passphrase"],"ascii").toArrayBuffer();v.identity.loadPrivate(t.identityBuf,r)}else{v.identity.loadPublic(t.identityBuf)}}catch(u){if("enigma-invalid-pinkey"==u.message){return{error:"identity-could-not-be-loaded",jump:"askIdentityReadPassphrase"}}if("enigma-identity-invalid"==u.message){return{error:"invalid-identity",terminate:true}}return{error:"identity-could-not-be-loaded",terminate:true}}if(!t.isPrivate){return{data:v,jump:"saveIdentity"}}return{data:v}});o.push(function n(){return{question:"text.passphrase"}});o.push(function q(u,t){var x=e.get("enigma.interface.storage")(l);var r=u.identity.getFingerprint(true);if(u.isPrivate){var s=e.get("util.encoding")(t["text.passphrase"],"ascii").toArrayBuffer();var v=u.identity.exportPrivate(s)}else{var v=u.identity.exportPublic()}var w=e.get("util.encoding")(v).toBase64();x.value(r,w);x.note(r,"subject",u.identity.getSubject());x.note(r,"isPrivate",u.isPrivate);x.note(r,"algorithm",u.identity.getAlgorithm());return{terminate:r}});return o}var f={variables:{"text.data":{type:"string",validate:function(h){return(0==h.length%2)&&/^[0-9a-f]+$/i.test(h)}},"text.passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}},"text.read-passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}}},errors:["identity-could-not-be-loaded","invalid-identity"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.identity-import",f)})(a);(function(e){function g(k,i){var j=[];j.push(function m(){return{question:"option.list-private-identities-only"}});j.push(function l(){return{question:"option.filter-by-keywords"}});j.push(function h(r,x){i("Operation - listing identity, received.");if(x["option.list-private-identities-only"]){i("The list will ONLY include private identities.")}i("Following keywords will be used to filter the subject:\n "+x["option.filter-by-keywords"]);var n=false;if(x["option.filter-by-keywords"]){n=x["option.filter-by-keywords"].toLowerCase().split(" ")}var u=e.get("enigma.interface.storage")(k),A=u.all();var y={},p,z,t,w;var s,v=false;for(var q in A){p=A[q];t=u.note(p,"isPrivate");z=u.note(p,"subject");w=u.note(p,"algorithm");if(x["option.list-private-identities-only"]&&!t){continue}if(n){s=z.toLowerCase();v=false;for(var o in n){if(!n[o]){continue}if(s.indexOf(n[o])<0){v=true;break}}if(v){continue}}y[p]={"private":t,subject:z,fingerprint:p,algorithm:w}}return{terminate:y}});return j}var f={variables:{"option.list-private-identities-only":"boolean","option.filter-by-keywords":"string"},errors:["option-results-in-empty-return"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.identity-list",f)})(a);(function(e){e.set("enigma.interface.api.message.common.loadIdentity",function(j,i,h){var m=e.get("enigma.interface.storage")(j);var g=m.value(i),k=m.note(i,"isPrivate")||false;if(!g){return false}if(!k&&h){return false}g=e.get("util.encoding")(g,"base64").toArrayBuffer();var f=e.get("enigma.identity")();try{if(k&&h){f.loadPrivate(g,h)}else{f.loadPublic(g)}}catch(l){console.error("unable to load this identity");console.error(l);return false}return f})})(a);(function(e){function g(m,l){var n=[];n.push(function i(){return{question:"text.data"}});n.push(function p(s,r){var u=e.get("util.encoding")(r["text.data"],"hex").toArrayBuffer();s.message=e.get("enigma.message")();try{s.message.read(u)}catch(t){return{error:"unable-to-read-message",terminate:true}}return{data:s}});n.push(function j(w,v){if(undefined==w.message.decrypt){return{jump:"tryVerify"}}l("Decryption needed.");var x=e.get("enigma.interface.storage")(m);var u=w.message.getReceivers();var s;var r=[];for(var t in u){if(!/^[0-9a-z]+$/i.test(u[t])){continue}s=u[t];if(true!=x.note(s,"isPrivate")){continue}r.push(s)}return{data:{decrypt:r}}});n.push(function o(s,r){if(s.decrypt.length<1){l("No more identity to try for decryption. End.");return{error:"no-identity-to-decrypt",terminate:true}}var t=e.get("enigma.interface.storage")(m);l("Try to decrypt with identity, fingerprint="+s.decrypt[0]);return{question:"text.passphrase",hint:{fingerprint:s.decrypt[0],subject:t.note(s.decrypt[0],"subject")}}});n.push(function h(t,s){var v=e.get("enigma.interface.api.message.common.loadIdentity");try{var r=v(m,t.decrypt[0],e.get("util.encoding")(s["text.passphrase"],"ascii").toArrayBuffer());if(!r){return{error:"unable-to-load-identity",jump:"askDecryptPassphrase"}}}catch(u){return{error:"unable-to-load-identity",jump:"askDecryptPassphrase"}}try{t.message.decrypt(r)}catch(u){if("enigma-message-corrupted"==u.message){return{error:"message-corrupted",terminate:true}}else{t.decrypt.shift();return{data:{decrypt:t.decrypt},jump:"askDecryptPassphrase",error:"wrong-identity-to-decrypt"}}}return{}});n.push(function k(v,u){if(undefined==v.message.verify){l("Verification jumped, reason: no signature found.");return{data:{verify:{}},jump:"doer"}}l("Verification possible.");var y=e.get("enigma.interface.api.message.common.loadIdentity");var r={};var x=v.message.getSigners();for(var t in x){r[x[t]]=false;try{var s=y(m,x[t],false);if(!s){continue}}catch(w){continue}try{if(true===v.message.verify(s)){r[x[t]]=true}}catch(w){}}return{data:{verify:r}}});n.push(function q(t,s){var r={};r.plaintext=e.get("util.encoding")(t.message.getPlaintext()).toHEX();r.verify=t.verify;return{terminate:r}});return n}var f={variables:{"text.data":{type:"string",validate:function(h){return 0==h.length%2&&/^[0-9a-f]+$/i.test(h)}},"text.passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}}},errors:["unable-to-read-message","unable-to-load-identity","no-identity-to-decrypt","message-corrupted","wrong-identity-to-decrypt"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.message-read",f)})(a);(function(e){function g(n,l){var q=[];q.push(function h(){return{question:"text.data"}});q.push(function r(v,u){var w=e.get("util.encoding")(u["text.data"],"hex").toArrayBuffer();v.message=e.get("enigma.message")();v.message.write(w);return{data:v}});q.push(function t(){return{question:"option.add-encrypt"}});q.push(function o(v,u){if(!u["option.add-encrypt"]){return{jump:"askAddSign"}}return{question:"text.fingerprint"}});q.push(function m(w,v){var y=e.get("enigma.interface.api.message.common.loadIdentity");try{var u=y(n,v["text.fingerprint"],false);if(!u){return{error:"unable-to-load-identity",jump:"askAddEncrypt"}}}catch(x){console.error(x);return{error:"unable-to-load-identity",jump:"askAddEncrypt"}}try{w.message.encrypt(u)}catch(x){return{error:"unable-to-encrypt-using-this-identity",jump:"askAddEncrypt"}}return{jump:"askAddEncrypt"}});q.push(function j(){return{question:"option.add-sign"}});q.push(function p(v,u){if(!u["option.add-sign"]){return{jump:"doer"}}return{question:"text.fingerprint"}});q.push(function k(v,u){return{question:"text.passphrase"}});q.push(function i(w,v){var y=e.get("enigma.interface.api.message.common.loadIdentity");try{var u=y(n,v["text.fingerprint"],e.get("util.encoding")(v["text.passphrase"],"ascii").toArrayBuffer());if(!u){return{error:"unable-to-load-identity",jump:"askAddSign"}}}catch(x){console.log(x);return{error:"unable-to-load-identity",jump:"askAddSign"}}try{w.message.sign(u)}catch(x){return{error:"unable-to-sign-using-this-identity",jump:"askAddSign"}}return{jump:"askAddSign"}});q.push(function s(x,w){if(undefined==x.message.done){return{error:"nothing-to-do",terminate:true}}var u=x.message.done();var v=e.get("util.encoding")(u).toHEX();return{terminate:v}});return q}var f={variables:{"text.data":{type:"string",validate:function(h){return 0==h.length%2&&/^[0-9a-f]+$/i.test(h)}},"option.add-encrypt":"boolean","option.add-sign":"boolean","text.fingerprint":{type:"string",validate:function(h){return/^[0-9a-z]+$/i.test(h)}},"text.passphrase":{type:"string",validate:function(h){return/^[\x20-\x7E]{32,}$/.test(h)}}},errors:["unable-to-load-identity","unable-to-encrypt-using-this-identity","unable-to-sign-using-this-identity","nothing-to-do"],constructor:function(i,h){return g(i,h)}};e.set("enigma.interface.api.message-write",f)})(a);(function(e){var h=["identity-list","identity-generate","identity-import","identity-export","identity-delete","message-write","message-read"];function g(y,x,m,s,k){var q=this;var n={};var l=e.get("util.type");var C=/^function\s([0-9a-z\_]+)\(/i,u,o;for(var v in y){if(!l(y[v]).isFunction()){throw new Error("Non function defined.")}u=C.exec(y[v].toString());if(!u){continue}o=u[1];n[o]=v}var B={error:[],question:[],terminated:[]};this.onError=function(i){B.error.push(i)};this.onQuestion=function(i){B.question.push(i)};this.onTerminated=function(i){B.terminated.push(i)};function r(G,E,D){for(var F in B[G]){B[G][F](E,D)}}var p={};this.assign=function(D,i){p[D]=i;return q};var A=false;var t=0,z={},j={};function w(){delete q.answer;delete q.cancel;if(t>=y.length||A){return r("terminated",z)}var i=y[t](z,j);if(!l(i).isObject()){throw new Error("Result is not an object.")}if(l(i.data).isObject()){for(var G in i.data){z[G]=i.data[G]}}if(i.error){if(k.indexOf(i.error)<0){throw new Error("Undeclared error being thrown.")}var F={id:i.error,description:x.error(i.error)};r("error",F)}if(i.jump){var E=n[i.jump];if(!E){throw new Error("Jump destination unknown.")}t=E;w()}else{if(i.question){if(!s[i.question]){throw new Error("Undeclared question being asked.")}if(p[i.question]){if(m(i.question,p[i.question])){j[i.question]=p[i.question];t++;w();return}}var D={id:i.question,description:x.question(i.question),type:s[i.question],hint:i.hint||undefined};(function(H){q.validate=function(I){return m(H,I)};q.answer=function(I){if(!m(H,I)){r("question",D);return false}j[H]=I;t++;w();return true};q.cancel=function(){A=true;w()}})(i.question);r("question",D)}else{if(undefined!==i.terminate){r("terminated",i.terminate)}else{t++;w()}}}}this.start=function(){delete q.onError;delete q.onQuestion;delete q.onTerminated;delete q.assign;delete q.start;w()};return this}function f(j){var i=j.translator,k=j.storage;if(!(i&&k)){throw new Error("Missing components for initialization.")}return function(n){var u=e.get("util.type");if(h.indexOf(n)<0){throw new Error("Unknown API")}var q=e.get("enigma.interface.api."+n);if(!q){throw new Error("API not exists or not loaded.")}var w=q.variables,v=q.errors;var s={};for(var p in w){if(u(w[p]).isString()){s[p]=w[p]}else{if(u(w[p]).isArray()){s[p]=w[p][0]}else{s[p]=w[p].type}}}var l=function(x,z){var B=w[x];function y(C,D){if("string"===C){return u(D).isString()}else{if("boolean"===C){return u(D).isBoolean()}else{if("number"===C){return u(D).isNumber()}else{if("date"===C){return u(D).isDate()}else{if(u(C).isArray()){if("enum"==C[0]){return C[1].indexOf(D)>=0}}}}}}throw new Error("Unknown type descriptor")}var A=u(B);if(A.isString()||A.isArray()){return y(B,z)}if(A.isObject()){if(!y(B.type,z)){return false}if(!B.validate(z)){return false}return true}throw new Error("Unknown variable descriptor")};var m=new Date().getTime();var o=function(y){var x=(new Date().getTime()-m)/1000;console.log("["+n+"]["+x+"] "+y)};var r=q.constructor(k,o);var t=new g(r,i,l,s,v);return t}}e.exp("enigma.interface",f)})(a);(function(e){function f(j){var h=this;function i(n){var k=[],m;for(var l=0;l<j.length;l++){m=j.key(l);if(n===m.slice(0,n.length)){k.push(m.slice(n.length))}}return k}this.all=function(){return i("value.")};function g(k,l){if(undefined===l){try{return JSON.parse(j.getItem(k))}catch(m){return null}}else{if(null===l){j.removeItem(k);return h}else{console.log("data set:",k,JSON.stringify(l));j.setItem(k,JSON.stringify(l));return h}}}this.remove=function(m){if(!/^[0-9a-z\-_]+$/i.test(m)){throw new Error("Invalid key")}h.value(m,null);var n="note."+m+".";var l=i(n);for(var k=0;k<l.length;k++){g(n+l[k],null)}};this.value=function(k,m){if(!/^[0-9a-z\-_]+$/i.test(k)){throw new Error("Invalid key")}var l="value."+k;return g(l,m)};this.note=function(l,k,n){if(!/^[0-9a-z\-_]+$/i.test(l)){throw new Error("Invalid key")}if(!/^[0-9a-z\-_]+$/i.test(k)){throw new Error("Invalid note key")}var m="note."+l+"."+k;return g(m,n)};return this}e.set("enigma.interface.storage",function(g){return new f(g)})})(a);(function(f){var e=(("undefined"!==typeof ENIGMA_ENHANCEMENT)&&("undefined"!==typeof ENIGMA_ENHANCEMENT.getRandomBytes));if(e){f.acc("util.srand.getRandomBytes",function(g){return ENIGMA_ENHANCEMENT.getRandomBytes(g)})}})(a);(function(g){if(!g.get("env.isNode")){return}try{var k=require("crypto").createHash,f=require("buffer")}catch(j){return}var i=true;try{k("whirlpool")}catch(j){i=false}var h=true;try{k("ripemd160")}catch(j){h=false}if(i){g.acc("hash.algorithms.whirlpool",function(){var e=this;this.name="WHIRLPOOL";this.blockSize=64;this.digestSize=64;this.hash=function(p){var n=k("whirlpool");n.update(new f.Buffer(new Uint8Array(p)));var l=n.digest(),o=new Uint8Array(l.length);for(var m=0;m<o.length;m++){o[m]=l[m]}return o.buffer};return this})}if(i){g.acc("hash.algorithms.ripemd160",function(){var e=this;this.name="RIPEMD160";this.blockSize=64;this.digestSize=20;this.hash=function(p){var n=k("ripemd160");n.update(new f.Buffer(new Uint8Array(p)));var l=n.digest(),o=new Uint8Array(l.length);for(var m=0;m<o.length;m++){o[m]=l[m]}return o.buffer};return this})}})(a);if("undefined"!=typeof module&&"undefined"!=module.exports){module.exports=c}else{define([],function(){return c})}return c})();